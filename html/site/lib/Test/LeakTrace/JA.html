<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#VERSION">VERSION</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#INTERFACE">INTERFACE</a>
    <ul>
      <li><a href="#Exported-functions">Exported functions</a>
        <ul>
          <li><a href="#leaked_info-BLOCK">leaked_info { BLOCK }</a></li>
          <li><a href="#leaked_refs-BLOCK">leaked_refs { BLOCK }</a></li>
          <li><a href="#leaked_count-BLOCK">leaked_count { BLOCK }</a></li>
          <li><a href="#leaktrace-BLOCK-mode-callback">leaktrace { BLOCK } ?($mode | \&amp;callback)</a></li>
          <li><a href="#no_leaks_ok-BLOCK-description">no_leaks_ok { BLOCK } ?$description</a></li>
          <li><a href="#leaks_cmp_ok-BLOCK-cmp_op-count-description">leaks_cmp_ok { BLOCK } $cmp_op, $count, ?$description</a></li>
        </ul>
      </li>
      <li><a href="#Script-interface">Script interface</a></li>
    </ul>
  </li>
  <li><a href="#EXAMPLES">EXAMPLES</a>
    <ul>
      <li><a href="#Testing-modules">Testing modules</a></li>
    </ul>
  </li>
  <li><a href="#GUTS">GUTS</a></li>
  <li><a href="#DEPENDENCIES">DEPENDENCIES</a></li>
  <li><a href="#CAVEATS">CAVEATS</a></li>
  <li><a href="#BUGS">BUGS</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#LICENSE-AND-COPYRIGHT">LICENSE AND COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Test::LeakTrace::JA - &#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;&#x8FFD;&#x8DE1;&#x3059;&#x308B;</p>

<h1 id="VERSION">VERSION</h1>

<p>This document describes Test::LeakTrace version 0.16.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code>        use Test::LeakTrace;

        # simple report
        leaktrace{
                # ...
        };

        # verbose output
        leaktrace{
                # ...
        } -verbose;

        # with callback
        leaktrace{
                # ...
        } sub {
                my($ref, $file, $line) = @_;
                warn &quot;leaked $ref from $file line\n&quot;;
        };

        my @refs = leaked_refs{
                # ...
        };
        my @info = leaked_info{
                # ...
        };

        my $count = leaked_count{
                # ...
        };

        # standard test interface
        use Test::LeakTrace;

        no_leaks_ok{
                # ...
        } &quot;description&quot;;

        leaks_cmp_ok{
                # ...
        } &#39;&lt;&#39;, 10;</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Perl&#x306E;GC&#x306F;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#x30AB;&#x30A6;&#x30F3;&#x30BF;&#x3092;&#x7528;&#x3044;&#x305F;&#x3082;&#x306E;&#x306A;&#x306E;&#x3067;&#xFF0C;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x304C;&#x958B;&#x653E;&#x3055;&#x308C;&#x308B;&#x30BF;&#x30A4;&#x30DF;&#x30F3;&#x30B0;&#x304C;&#x660E;&#x78BA;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x3084;&#x4F53;&#x611F;&#x901F;&#x5EA6;&#x304C;&#x9AD8;&#x901F;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x306A;&#x3069;&#x6570;&#x3005;&#x306E;&#x5229;&#x70B9;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002; &#x305D;&#x306E;&#x4E00;&#x65B9;&#x3067;&#xFF0C;&#x5FAA;&#x74B0;&#x53C2;&#x7167;&#x3092;&#x958B;&#x653E;&#x3067;&#x304D;&#x306A;&#x3044;&#x3053;&#x3068;&#xFF0C;C&#x30EC;&#x30D9;&#x30EB;&#x3067;&#x306E;&#x64CD;&#x4F5C;&#x3067;&#x30DF;&#x30B9;&#x3057;&#x3084;&#x3059;&#x3044;&#x306A;&#x3069;&#xFF0C;&#x554F;&#x984C;&#x70B9;&#x304C;&#x3044;&#x304F;&#x3064;&#x304B;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;&#x305D;&#x308C;&#x3089;&#x306E;&#x554F;&#x984C;&#x70B9;&#x306E;&#x307B;&#x3068;&#x3093;&#x3069;&#x306F;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x306B;&#x95A2;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3059;&#x304B;&#x3089;&#xFF0C;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;&#x8FFD;&#x8DE1;&#x3059;&#x308B;&#x3053;&#x3068;&#x306F;&#x975E;&#x5E38;&#x306B;&#x91CD;&#x8981;&#x306A;&#x8AB2;&#x984C;&#x3067;&#x3059;&#x3002;</p>

<p><code>Test::LeakTrce</code>&#x306F;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;&#x8FFD;&#x8DE1;&#x3059;&#x308B;&#x305F;&#x3081;&#x306E;&#x3044;&#x304F;&#x3064;&#x304B;&#x306E;&#x30E6;&#x30FC;&#x30C6;&#x30A3;&#x30EA;&#x30C6;&#x30A3;&#x3068;<code>Test::Builder</code>&#x30D9;&#x30FC;&#x30B9;&#x306E;&#x30C6;&#x30B9;&#x30C8;&#x95A2;&#x6570;&#x3092;&#x63D0;&#x4F9B;&#x3057;&#x307E;&#x3059;&#x3002;&#x3053;&#x306E;&#x30E2;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x306F;Perl&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x30B7;&#x30B9;&#x30C6;&#x30E0;&#x3067;&#x3042;&#x308B;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3059;&#x308B;&#x305F;&#x3081;&#xFF0C;SV&#x306B;&#x95A2;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3042;&#x308C;&#x3070;&#x4E0E;&#x3048;&#x3089;&#x308C;&#x305F;&#x30B3;&#x30FC;&#x30C9;&#x306E;&#x3069;&#x3093;&#x306A;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3067;&#x3082;&#x691C;&#x51FA;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;&#x3064;&#x307E;&#x308A;&#xFF0C;Perl&#x30EC;&#x30D9;&#x30EB;&#x3067;&#x306E;&#x5FAA;&#x74B0;&#x53C2;&#x7167;&#x3092;&#x59CB;&#x3081;&#x3068;&#x3057;&#x3066;&#xFF0C;XS&#x30E2;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3084;Perl&#x81EA;&#x8EAB;&#x306E;&#x30D0;&#x30B0;&#x306B;&#x3088;&#x308B;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;&#x8FFD;&#x8DE1;&#x3059;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;</p>

<p>&#x3053;&#x3053;&#x3067;<b>&#x30EA;&#x30FC;&#x30AF;</b>&#x3068;&#x306F;&#xFF0C;&#x7279;&#x5B9A;&#x306E;&#x30B9;&#x30B3;&#x30FC;&#x30D7;&#x5185;&#x3067;&#x65B0;&#x305F;&#x306B;&#x4F5C;&#x6210;&#x3055;&#x308C;&#x3066;&#xFF0C;&#x305D;&#x306E;&#x30B9;&#x30B3;&#x30FC;&#x30D7;&#x7D42;&#x4E86;&#x5F8C;&#x306B;&#x3082;&#x6B8B;&#x3063;&#x3066;&#x3044;&#x308B;&#x5024;&#x3092;&#x610F;&#x5473;&#x3057;&#x307E;&#x3059;&#x3002;&#x3053;&#x308C;&#x306F;&#xFF0C;&#x65B0;&#x305F;&#x306B;&#x4F5C;&#x6210;&#x3055;&#x308C;&#x305F;&#x30B0;&#x30ED;&#x30FC;&#x30D0;&#x30EB;&#x306A;&#x5024;&#x3084;Perl&#x304C;&#x6697;&#x9ED9;&#x306E;&#x3046;&#x3061;&#x306B;&#x4F5C;&#x6210;&#x3059;&#x308B;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x306E;&#x5024;&#x3082;&#x542B;&#x307F;&#x307E;&#x3059;&#x3002;&#x305F;&#x3068;&#x3048;&#x3070;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x8FFD;&#x8DE1;&#x3092;&#x884C;&#x3063;&#x3066;&#x3044;&#x308B;&#x6700;&#x4E2D;&#x306B;&#x65B0;&#x305F;&#x306B;&#x540D;&#x524D;&#x3064;&#x304D;&#x30B5;&#x30D6;&#x30EB;&#x30FC;&#x30C1;&#x30F3;&#x3092;&#x5B9A;&#x7FA9;&#x3059;&#x308C;&#x3070;&#xFF0C;&#x305D;&#x308C;&#x306F;&#x30EA;&#x30FC;&#x30AF;&#x3068;&#x307F;&#x306A;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;&#x307E;&#x305F;&#xFF0C;&#x7D99;&#x627F;&#x3057;&#x305F;&#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x3092;&#x547C;&#x3073;&#x51FA;&#x3057;&#x305F;&#x308A;&#xFF0C;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x3092;&#x4F5C;&#x6210;&#x3057;&#x305F;&#x308A;&#x3059;&#x308B;&#x3060;&#x3051;&#x3067;&#x69D8;&#x3005;&#x306A;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x304C;&#x751F;&#x6210;&#x3055;&#x308C;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x304C;&#x5831;&#x544A;&#x3055;&#x308C;&#x308B;&#x53EF;&#x80FD;&#x6027;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;</p>

<h1 id="INTERFACE">INTERFACE</h1>

<h2 id="Exported-functions">Exported functions</h2>

<h3 id="leaked_info-BLOCK"><code>leaked_info { BLOCK }</code></h3>

<p><i>BLOCK</i>&#x3092;&#x5B9F;&#x884C;&#x3057;&#xFF0C;&#x8FFD;&#x8DE1;&#x7D50;&#x679C;&#x3092;&#x30EA;&#x30B9;&#x30C8;&#x3067;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x3002; &#x7D50;&#x679C;&#x306F;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;&#x5024;&#x306E;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#xFF0C;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#xFF0C;&#x884C;&#x756A;&#x53F7;&#x306E;&#x4E09;&#x8981;&#x7D20;&#x3092;&#x6301;&#x3064;&#x914D;&#x5217;&#xFF0C;&#x3064;&#x307E;&#x308A;<code>[$ref, $file, $line]</code>&#x306E;&#x30EA;&#x30B9;&#x30C8;&#x3068;&#x306A;&#x3063;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;</p>

<p>&#x306A;&#x304A;&#xFF0C;&#x3053;&#x306E;&#x95A2;&#x6570;&#x306F;Perl&#x5185;&#x90E8;&#x3067;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x5024;&#x3092;&#x8FD4;&#x3059;&#x53EF;&#x80FD;&#x6027;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;&#x305D;&#x306E;&#x3088;&#x3046;&#x306A;&#x5185;&#x90E8;&#x7528;&#x306E;&#x5024;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x3068;Perl&#x5B9F;&#x884C;&#x74B0;&#x5883;&#x306B;&#x81F4;&#x547D;&#x7684;&#x306A;&#x5F71;&#x97FF;&#x3092;&#x4E0E;&#x3048;&#x308B;&#x53EF;&#x80FD;&#x6027;&#x304C;&#x3042;&#x308B;&#x306E;&#x3067;&#x6CE8;&#x610F;&#x3057;&#x3066;&#x304F;&#x3060;&#x3055;&#x3044;&#x3002;&#x307E;&#x305F;&#xFF0C;&#x914D;&#x5217;&#x3084;&#x30CF;&#x30C3;&#x30B7;&#x30E5;&#x306E;&#x8981;&#x7D20;&#x3068;&#x3057;&#x3066;&#xFF0C;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#x3067;&#x306F;&#x306A;&#x3044;&#x914D;&#x5217;&#x3084;&#x30CF;&#x30C3;&#x30B7;&#x30E5;&#x305D;&#x308C;&#x81EA;&#x4F53;&#x304C;&#x542B;&#x307E;&#x308C;&#x308B;&#x53EF;&#x80FD;&#x6027;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;&#x305D;&#x306E;&#x3088;&#x3046;&#x306A;&#x5024;&#x306F;&#x901A;&#x5E38;Perl&#x30EC;&#x30D9;&#x30EB;&#x3067;&#x64CD;&#x4F5C;&#x3059;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x307E;&#x305B;&#x3093;&#x3002;&#x305F;&#x3068;&#x3048;&#x3070;<code>Data::Dumper</code>&#x306A;&#x3069;&#x3067;&#x51FA;&#x529B;&#x3059;&#x308B;&#x3053;&#x3068;&#x306F;&#x3067;&#x304D;&#x307E;&#x305B;&#x3093;&#x3002;</p>

<h3 id="leaked_refs-BLOCK"><code>leaked_refs { BLOCK }</code></h3>

<p><i>BLOCK</i>&#x3092;&#x5B9F;&#x884C;&#x3057;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#x306E;&#x30EA;&#x30B9;&#x30C8;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x3002;</p>

<p><code>map{ $_-&gt;[0] } leaked_info{ BLOCK }</code>&#x3068;&#x540C;&#x3058;&#x3067;&#x3059;&#x304C;&#xFF0C;&#x3088;&#x308A;&#x9AD8;&#x901F;&#x3067;&#x3059;&#x3002;</p>

<h3 id="leaked_count-BLOCK"><code>leaked_count { BLOCK }</code></h3>

<p><i>BLOCK</i>&#x3092;&#x5B9F;&#x884C;&#x3057;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#x306E;&#x500B;&#x6570;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x3002;</p>

<p><code>leaked_info()</code>&#x3068;<code>leaked_refs()</code>&#x3082;&#x30B9;&#x30AB;&#x30E9;&#x30B3;&#x30F3;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3067;&#x306F;&#x500B;&#x6570;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x304C;&#xFF0C; <code>leaked_count()</code>&#x306F;&#x30B3;&#x30F3;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x306B;&#x4F9D;&#x5B58;&#x3057;&#x307E;&#x305B;&#x3093;&#x3002;</p>

<h3 id="leaktrace-BLOCK-mode-callback"><code>leaktrace { BLOCK } ?($mode | \&amp;callback)</code></h3>

<p><i>BLOCK</i>&#x3092;&#x5B9F;&#x884C;&#x3057;&#xFF0C;&#x305D;&#x306E;&#x4E2D;&#x3067;&#x8D77;&#x304D;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;<code>*STDERR</code>&#x306B;&#x5831;&#x544A;&#x3057;&#x307E;&#x3059;&#x3002;</p>

<p>&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x306E;&#x5831;&#x544A;&#x306F;<i>$mode</i>&#x3067;&#x6307;&#x5B9A;&#x3057;&#x305F;&#x30E2;&#x30FC;&#x30C9;&#x306B;&#x5F93;&#x3044;&#x307E;&#x3059;&#x3002; &#x53D7;&#x3051;&#x4ED8;&#x3051;&#x308B;<i>$mode</i>&#x306F;&#x4EE5;&#x4E0B;&#x306E;&#x901A;&#x308A;&#x3067;&#x3059;&#xFF1A;</p>

<dl>

<dt id="simple">-simple</dt>
<dd>

<p>&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306E;&#x30E2;&#x30FC;&#x30C9;&#x3067;&#x3059;&#x3002;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x578B;&#x3068;&#x30A2;&#x30C9;&#x30EC;&#x30B9;&#xFF0C;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#xFF0C;&#x884C;&#x756A;&#x53F7;&#x3092;&#x5831;&#x544A;&#x3057;&#x307E;&#x3059;&#x3002;</p>

</dd>
<dt id="sv_dump">-sv_dump</dt>
<dd>

<p><b>-simple</b>&#x306B;&#x52A0;&#x3048;&#x3066;&#xFF0C;<code>sv_dump()</code>&#x3067;SV&#x306E;&#x4E2D;&#x8EAB;&#x3092;&#x30C0;&#x30F3;&#x30D7;&#x3057;&#x307E;&#x3059;&#x3002; &#x3053;&#x308C;&#x306F;&#xFF0C;<code>Devel::Peek::Dump()</code>&#x306E;&#x51FA;&#x529B;&#x3068;&#x307B;&#x307C;&#x540C;&#x3058;&#x3067;&#x3059;&#x3002;</p>

</dd>
<dt id="lines">-lines</dt>
<dd>

<p><b>-simple</b>&#x306B;&#x52A0;&#x3048;&#x3066;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x3066;&#x3044;&#x308B;&#x3068;&#x898B;&#x3089;&#x308C;&#x308B;&#x884C;&#x306E;&#x5468;&#x8FBA;&#x3092;&#x51FA;&#x529B;&#x3057;&#x307E;&#x3059;&#x3002;</p>

</dd>
<dt id="verbose">-verbose</dt>
<dd>

<p><b>-simple</b>&#x3068;<b>-sv_dump</b>&#x3068;<b>-lines</b>&#x306E;&#x5168;&#x3066;&#x3092;&#x51FA;&#x529B;&#x3057;&#x307E;&#x3059;&#x3002;</p>

</dd>
</dl>

<p>&#x3088;&#x308A;&#x7D30;&#x304B;&#x306A;&#x5236;&#x5FA1;&#x306E;&#x305F;&#x3081;&#x306B;&#x30B3;&#x30FC;&#x30EB;&#x30D0;&#x30C3;&#x30AF;&#x3092;&#x6307;&#x5B9A;&#x3059;&#x308B;&#x3053;&#x3068;&#x3082;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002; <i>\&amp;callback</i>&#x306F;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x6BCE;&#x306B;&#x547C;&#x3073;&#x51FA;&#x3055;&#x308C;&#xFF0C;&#x305D;&#x306E;&#x5F15;&#x6570;&#x306F;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x30EA;&#x30D5;&#x30A1;&#x30EC;&#x30F3;&#x30B9;&#xFF0C;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#xFF0C;&#x884C;&#x756A;&#x53F7;&#x306E;3&#x3064;&#x3067;&#x3059;&#x3002;</p>

<h3 id="no_leaks_ok-BLOCK-description"><code>no_leaks_ok { BLOCK } ?$description</code></h3>

<p><i>BLOCK</i>&#x306B;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x304C;&#x306A;&#x3044;&#x3053;&#x3068;&#x30C6;&#x30B9;&#x30C8;&#x3057;&#x307E;&#x3059;&#x3002; &#x3053;&#x308C;&#x306F;<code>Test::Builder</code>&#x30D9;&#x30FC;&#x30B9;&#x306E;&#x30C6;&#x30B9;&#x30C8;&#x95A2;&#x6570;&#x3067;&#x3059;&#x3002;</p>

<p>&#x306A;&#x304A;&#xFF0C;<i>BLOCK</i>&#x306F;&#x8907;&#x6570;&#x56DE;&#x5B9F;&#x884C;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;&#x3053;&#x308C;&#x306F;&#xFF0C;&#x521D;&#x56DE;&#x306E;&#x5B9F;&#x884C;&#x3067;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x7528;&#x610F;&#x3059;&#x308B;&#x53EF;&#x80FD;&#x6027;&#x3092;&#x8003;&#x616E;&#x3059;&#x308B;&#x305F;&#x3081;&#x3067;&#x3059;&#x3002;</p>

<h3 id="leaks_cmp_ok-BLOCK-cmp_op-count-description"><code>leaks_cmp_ok { BLOCK } $cmp_op, $count, ?$description</code></h3>

<p><i>BLOCK</i>&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x6570;&#x3068;&#x7279;&#x5B9A;&#x306E;&#x6570;&#x5024;&#x3092;&#x6BD4;&#x8F03;&#x3059;&#x308B;&#x30C6;&#x30B9;&#x30C8;&#x3092;&#x884C;&#x3044;&#x307E;&#x3059;&#x3002; &#x3053;&#x308C;&#x306F;<code>Test::Builder</code>&#x30D9;&#x30FC;&#x30B9;&#x306E;&#x30C6;&#x30B9;&#x30C8;&#x95A2;&#x6570;&#x3067;&#x3059;&#x3002;</p>

<p>&#x306A;&#x304A;&#xFF0C;<i>BLOCK</i>&#x306F;&#x8907;&#x6570;&#x56DE;&#x5B9F;&#x884C;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;&#x3053;&#x308C;&#x306F;&#xFF0C;&#x521D;&#x56DE;&#x306E;&#x5B9F;&#x884C;&#x3067;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x7528;&#x610F;&#x3059;&#x308B;&#x53EF;&#x80FD;&#x6027;&#x3092;&#x8003;&#x616E;&#x3059;&#x308B;&#x305F;&#x3081;&#x3067;&#x3059;&#x3002;</p>

<h2 id="Script-interface">Script interface</h2>

<p><code>Devel::LeakTrace</code>&#x3068;&#x540C;&#x69D8;&#x306B;&#xFF0C;&#x30B9;&#x30AF;&#x30EA;&#x30D7;&#x30C8;&#x306E;&#x30EA;&#x30FC;&#x30AF;&#x8FFD;&#x8DE1;&#x306E;&#x305F;&#x3081;&#x306B;<code>Test::LeakTrace::Script</code>&#x304C;&#x63D0;&#x4F9B;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;<code>use Test::LeakTrace::Script</code>&#x5BA3;&#x8A00;&#x306E;&#x5F15;&#x6570;&#x306F;<code>leaktrace()</code>&#x3068;&#x540C;&#x3058;&#x3067;&#x3059;&#x3002;</p>

<pre><code>        $ TEST_LEAKTRACE=-sv_dump perl -MTest::LeakTrace::Script script.pl
        $ perl -MTest::LeakTrace::Script=-verbose script.pl

        #!perl
        # ...

        use Test::LeakTrace::Script sub{
                my($ref, $file, $line) = @_;
                # ...
        };

        # ...</code></pre>

<h1 id="EXAMPLES">EXAMPLES</h1>

<h2 id="Testing-modules">Testing modules</h2>

<p>&#x4EE5;&#x4E0B;&#x306F;&#x30E2;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x3092;&#x30C1;&#x30A7;&#x30C3;&#x30AF;&#x3059;&#x308B;&#x30C6;&#x30B9;&#x30C8;&#x30B9;&#x30AF;&#x30EA;&#x30D7;&#x30C8;&#x306E;&#x30C6;&#x30F3;&#x30D7;&#x30EC;&#x30FC;&#x30C8;&#x3067;&#x3059;&#x3002;</p>

<pre><code>        #!perl -w
        use strict;
        use constant HAS_LEAKTRACE =&gt; eval{ require Test::LeakTrace };
        use Test::More HAS_LEAKTRACE ? (tests =&gt; 1) : (skip_all =&gt; &#39;require Test::LeakTrace&#39;);
        use Test::LeakTrace;

        use Some::Module;

        leaks_cmp_ok{
                my $o = Some::Module-&gt;new();
                $o-&gt;something();
                $o-&gt;something_else();
        } &#39;&lt;&#39;, 1;</code></pre>

<h1 id="GUTS">GUTS</h1>

<p><code>Test::LeakTrace</code>&#x306F;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3057;&#x307E;&#x3059;&#x3002;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3068;&#x306F;&#xFF0C;Perl&#x304C;&#x4F5C;&#x6210;&#x3059;&#x308B;SV&#x306E;&#x305F;&#x3081;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x30B7;&#x30B9;&#x30C6;&#x30E0;&#x3067;&#x3042;&#x308A;&#xFF0C;<i>sv.c</i>&#x3067;&#x5B9F;&#x88C5;&#x3055;&#x308C;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002; &#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x306E;&#x8D70;&#x67FB;&#x306B;&#x306F;<i>sv.c</i>&#x306B;&#x3042;&#x308B;<code>S_visit()</code>&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x3092;&#x5143;&#x306B;&#x3057;&#x305F;&#x30DE;&#x30AF;&#x30ED;&#x3092;&#x7528;&#x3044;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;</p>

<p>&#x3055;&#x3066;&#xFF0C;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3059;&#x308C;&#x3070;&#xFF0C;&#x30E1;&#x30E2;&#x30EA;&#x30EA;&#x30FC;&#x30AF;&#x306E;&#x691C;&#x51FA;&#x305D;&#x306E;&#x3082;&#x306E;&#x306F;&#x7C21;&#x5358;&#x306B;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x601D;&#x3048;&#x307E;&#x3059;&#x3002;&#x307E;&#x305A;&#xFF0C;&#x30B3;&#x30FC;&#x30C9;&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;&#x524D;&#x306B;&#x4E00;&#x5EA6;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3057;&#xFF0C;&#x5168;&#x3066;&#x306E;SV&#x306B;&#x300C;&#x4F7F;&#x7528;&#x6E08;&#x307F;&#x300D;&#x306E;&#x5370;&#x3092;&#x4ED8;&#x3051;&#x3066;&#x304A;&#x304D;&#x307E;&#x3059;&#x3002;&#x6B21;&#x306B;&#xFF0C;&#x30B3;&#x30FC;&#x30C9;&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x5B9F;&#x884C;&#x5F8C;&#x306B;&#x3082;&#x3046;&#x4E00;&#x5EA6;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3057;&#xFF0C;&#x4F7F;&#x7528;&#x6E08;&#x307F;&#x306E;&#x5370;&#x304C;&#x3064;&#x3044;&#x3066;&#x3044;&#x306A;&#x3044;SV&#x304C;&#x3042;&#x308C;&#x3070;&#xFF0C;&#x305D;&#x308C;&#x306F;&#x30B3;&#x30FC;&#x30C9;&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x5185;&#x3067;&#x4F5C;&#x6210;&#x3055;&#x308C;&#xFF0C;&#x958B;&#x653E;&#x3055;&#x308C;&#x306A;&#x304B;&#x3063;&#x305F;SV&#x3060;&#x3068;&#x8003;&#x3048;&#x307E;&#x3059;&#x3002;&#x3042;&#x3068;&#x306F;&#x305D;&#x308C;&#x3092;&#x5831;&#x544A;&#x3059;&#x308B;&#x3060;&#x3051;&#x3067;&#x3059;&#x3002;&#x5B9F;&#x969B;&#x306B;&#x306F;&#xFF0C;SV&#x306B;&#x5BFE;&#x3057;&#x3066;&#x4F7F;&#x7528;&#x6E08;&#x307F;&#x306E;&#x5370;&#x3092;&#x4ED8;&#x3051;&#x308B;&#x30B9;&#x30DA;&#x30FC;&#x30B9;&#x304C;&#x306A;&#x3044;&#x305F;&#x3081;&#xFF0C;&#x30A4;&#x30F3;&#x30B5;&#x30A4;&#x30C9;&#x30A2;&#x30A6;&#x30C8;&#x6CD5;&#x3092;&#x5FDC;&#x7528;&#x3057;&#x3066;&#x5916;&#x90E8;&#x306E;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306B;&#x4F7F;&#x7528;&#x6E08;&#x307F;&#x306E;&#x5370;&#x3092;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3059;&#x3002; &#x3053;&#x308C;&#x3092;&#x4EEE;&#x306B;Perl&#x30B3;&#x30FC;&#x30C9;&#x3067;&#x66F8;&#x304F;&#x3068;&#x4EE5;&#x4E0B;&#x306E;&#x3088;&#x3046;&#x306B;&#x306A;&#x308A;&#x307E;&#x3059;&#x3002;</p>

<pre><code>        my %used_sv;
        foreach my $sv(@ARENA){
                $used_sv{$sv}++;
        }
        $block-&gt;();

        my @leaked
        foreach my $sv(@ARENA){
                if(not exists $used_sv{$sv}){
                        push @leaked, $sv;
                }
        }
        say &#39;leaked count: &#39;, scalar @leaked;</code></pre>

<p>&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x3092;&#x5F97;&#x308B;&#x3060;&#x3051;&#x306A;&#x3089;&#x3053;&#x306E;&#x65B9;&#x6CD5;&#x3067;&#x5341;&#x5206;&#x3067;&#x3059;&#x3002;&#x5B9F;&#x969B;&#xFF0C;<code>leaked_refs()</code>&#x3068;<code>leaked_count()</code>&#x306F;&#x3053;&#x306E;&#x3088;&#x3046;&#x306A;&#x65B9;&#x6CD5;&#x3067;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x3084;&#x305D;&#x306E;&#x500B;&#x6570;&#x3092;&#x8ABF;&#x3079;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;</p>

<p>&#x3057;&#x304B;&#x3057;&#xFF0C;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x30E1;&#x30F3;&#x30C8;&#x306E;&#x60C5;&#x5831;&#xFF0C;&#x3064;&#x307E;&#x308A;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#x3084;&#x884C;&#x756A;&#x53F7;&#x3092;&#x5F97;&#x308B;&#x305F;&#x3081;&#x306B;&#x306F;&#x3053;&#x308C;&#x3060;&#x3051;&#x3067;&#x306F;&#x4E0D;&#x5341;&#x5206;&#x3067;&#x3059;&#x3002;Perl 5.10&#x4EE5;&#x964D;&#x306B;&#x306F;SV&#x304C;&#x4F5C;&#x6210;&#x3055;&#x308C;&#x305F;&#x3068;&#x304D;&#x306E;&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x30E1;&#x30F3;&#x30C8;&#x60C5;&#x5831;&#x3092;&#x8FFD;&#x8DE1;&#x3059;&#x308B;&#x6A5F;&#x80FD;&#x304C;&#x3042;&#x308B;&#x306E;&#x3067;&#x3059;&#x304C;&#xFF0C;&#x3053;&#x306E;&#x6A5F;&#x80FD;&#x3092;&#x5229;&#x7528;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x306F;&#xFF0C;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30E9;&#x30AA;&#x30D7;&#x30B7;&#x30E7;&#x30F3;&#x3068;&#x3057;&#x3066;&#x306B;<code>-DDEBUG_LEAKING_SCALARS</code>&#x3092;&#x4E0E;&#x3048;&#x3066;Perl&#x3092;&#x30D3;&#x30EB;&#x30C9;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;&#x306A;&#x308A;&#x307E;&#x305B;&#x3093;&#x3002;</p>

<p>&#x305D;&#x3053;&#x3067;&#xFF0C;<code>Test::LeakTrace</code>&#x3067;&#x306F;&#x62E1;&#x5F35;&#x53EF;&#x80FD;&#x306A;<code>PL_runops</code>&#x3092;&#x5229;&#x7528;&#x3057;&#x3066;&#xFF0C;Perl VM&#x304C;OP&#x30B3;&#x30FC;&#x30C9;&#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;1&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x30E1;&#x30F3;&#x30C8;&#x6BCE;&#x306B;&#x30A2;&#x30EA;&#x30FC;&#x30CA;&#x3092;&#x8D70;&#x67FB;&#x3057;&#xFF0C;&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x30E1;&#x30F3;&#x30C8;&#x60C5;&#x5831;&#x3092;&#x8A18;&#x9332;&#x3057;&#x307E;&#x3059;&#x3002;&#x3053;&#x308C;&#x306F;&#xFF0C;1&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x30E1;&#x30F3;&#x30C8;&#x6BCE;&#x306B;&#x30DE;&#x30FC;&#x30AF;&#xFF06;&#x30B9;&#x30A4;&#x30FC;&#x30D7;&#x306E;&#x3088;&#x3046;&#x306A;&#x51E6;&#x7406;&#x3092;&#x884C;&#x3046;&#x306E;&#x306B;&#x7B49;&#x3057;&#x304F;&#xFF0C;&#x975E;&#x5E38;&#x306B;&#x6642;&#x9593;&#x304C;&#x639B;&#x304B;&#x308A;&#x307E;&#x3059;&#x3002;&#x3057;&#x304B;&#x3057;&#xFF0C;Perl&#x3092;&#x7279;&#x6B8A;&#x306A;&#x6761;&#x4EF6;&#x306E;&#x4E0B;&#x3067;&#x30D3;&#x30EB;&#x30C9;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x3082;&#x306A;&#x304F;&#xFF0C;&#x30D0;&#x30FC;&#x30B8;&#x30E7;&#x30F3;&#x306B;&#x4F9D;&#x5B58;&#x3057;&#x305F;&#x6A5F;&#x80FD;&#x3082;&#x307B;&#x3068;&#x3093;&#x3069;&#x4F7F;&#x7528;&#x3057;&#x306A;&#x3044;&#x305F;&#x3081;&#xFF0C;&#x591A;&#x304F;&#x306E;&#x74B0;&#x5883;&#x3067;&#x52D5;&#x304B;&#x3059;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;</p>

<p>&#x307E;&#x305F;&#xFF0C;<code>no_leaks_ok()</code>&#x306E;&#x3088;&#x3046;&#x306A;&#x30C6;&#x30B9;&#x30C8;&#x95A2;&#x6570;&#x306F;&#x307E;&#x305A;<code>leaked_count()</code>&#x3067;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;SV&#x306E;&#x500B;&#x6570;&#x3092;&#x5F97;&#x3066;&#x304B;&#x3089;&#xFF0C;&#x5FC5;&#x8981;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30EA;&#x30FC;&#x30AF;&#x3057;&#x305F;&#x4F4D;&#x7F6E;&#x3092;&#x7279;&#x5B9A;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;<code>leaktrace()</code>&#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;&#x305F;&#x3081;&#xFF0C;&#x30C6;&#x30B9;&#x30C8;&#x304C;&#x6210;&#x529F;&#x3059;&#x308B;&#x9650;&#x308A;&#x306F;&#x6642;&#x9593;&#x306E;&#x639B;&#x304B;&#x308B;&#x8FFD;&#x8DE1;&#x51E6;&#x7406;&#x306F;&#x3057;&#x307E;&#x305B;&#x3093;&#x3002;</p>

<h1 id="DEPENDENCIES">DEPENDENCIES</h1>

<p>Perl 5.8.1 or later, and a C compiler.</p>

<h1 id="CAVEATS">CAVEATS</h1>

<p><code>Test::LeakTrace</code>&#x306F;<code>Devel::Cover</code>&#x3068;&#x4E00;&#x7DD2;&#x306B;&#x52D5;&#x304B;&#x3059;&#x3053;&#x3068;&#x306F;&#x3067;&#x304D;&#x307E;&#x305B;&#x3093;&#x3002; &#x3057;&#x305F;&#x304C;&#x3063;&#x3066;&#xFF0C;<code>Devel::Cover</code>&#x306E;&#x5143;&#x3067;&#x52D5;&#x3044;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x304C;&#x691C;&#x51FA;&#x3055;&#x308C;&#x308B;&#x3068;&#xFF0C;&#x30C6;&#x30B9;&#x30C8;&#x95A2;&#x6570;&#x306F;&#x4F55;&#x3082;&#x884C;&#x308F;&#x305A;&#x306B;&#x30C6;&#x30B9;&#x30C8;&#x3092;&#x30D1;&#x30B9;&#x3055;&#x305B;&#x307E;&#x3059;&#x3002;</p>

<h1 id="BUGS">BUGS</h1>

<p>No bugs have been reported.</p>

<p>Please report any bugs or feature requests to the author.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a>Devel::LeakTrace</a>.</p>

<p><a>Devel::LeakTrace::Fast</a>.</p>

<p><a>Test::TraceObject</a>.</p>

<p><a>Test::Weak</a>.</p>

<p>For guts:</p>

<p><a href="../../../../lib/perl5/5.26.3/pod/perlguts.html">perlguts</a>.</p>

<p><a href="../../../../lib/perl5/5.26.3/pod/perlhack.html">perlhack</a>.</p>

<p><a>sv.c</a>.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Goro Fuji &lt;gfuji(at)cpan.org&gt;.</p>

<h1 id="LICENSE-AND-COPYRIGHT">LICENSE AND COPYRIGHT</h1>

<p>Copyright (c) 2009, Goro Fuji. Some rights reserved.</p>

<p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>


</body>

</html>


