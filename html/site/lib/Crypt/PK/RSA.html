<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#generate_key">generate_key</a></li>
      <li><a href="#import_key">import_key</a></li>
      <li><a href="#export_key_der">export_key_der</a></li>
      <li><a href="#export_key_pem">export_key_pem</a></li>
      <li><a href="#export_key_jwk">export_key_jwk</a></li>
      <li><a href="#export_key_jwk_thumbprint">export_key_jwk_thumbprint</a></li>
      <li><a href="#encrypt">encrypt</a></li>
      <li><a href="#decrypt">decrypt</a></li>
      <li><a href="#sign_message">sign_message</a></li>
      <li><a href="#verify_message">verify_message</a></li>
      <li><a href="#sign_hash">sign_hash</a></li>
      <li><a href="#verify_hash">verify_hash</a></li>
      <li><a href="#is_private">is_private</a></li>
      <li><a href="#size">size</a></li>
      <li><a href="#key2hash">key2hash</a></li>
    </ul>
  </li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#rsa_encrypt">rsa_encrypt</a></li>
      <li><a href="#rsa_decrypt">rsa_decrypt</a></li>
      <li><a href="#rsa_sign_message">rsa_sign_message</a></li>
      <li><a href="#rsa_verify_message">rsa_verify_message</a></li>
      <li><a href="#rsa_sign_hash">rsa_sign_hash</a></li>
      <li><a href="#rsa_verify_hash">rsa_verify_hash</a></li>
    </ul>
  </li>
  <li><a href="#OpenSSL-interoperability">OpenSSL interoperability</a>
    <ul>
      <li><a href="#Encrypt-by-OpenSSL-decrypt-by-Crypt::PK::RSA">Encrypt by OpenSSL, decrypt by Crypt::PK::RSA</a></li>
      <li><a href="#Encrypt-by-Crypt::PK::RSA-decrypt-by-OpenSSL">Encrypt by Crypt::PK::RSA, decrypt by OpenSSL</a></li>
      <li><a href="#Sign-by-OpenSSL-verify-by-Crypt::PK::RSA">Sign by OpenSSL, verify by Crypt::PK::RSA</a></li>
      <li><a href="#Sign-by-Crypt::PK::RSA-verify-by-OpenSSL">Sign by Crypt::PK::RSA, verify by OpenSSL</a></li>
      <li><a href="#Keys-generated-by-Crypt::PK::RSA">Keys generated by Crypt::PK::RSA</a></li>
      <li><a href="#Keys-generated-by-OpenSSL">Keys generated by OpenSSL</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Crypt::PK::RSA - Public key cryptography based on RSA</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> ### OO interface

 #Encryption: Alice
 my $pub = Crypt::PK::RSA-&gt;new(&#39;Bob_pub_rsa1.der&#39;);
 my $ct = $pub-&gt;encrypt(&quot;secret message&quot;);
 #
 #Encryption: Bob (received ciphertext $ct)
 my $priv = Crypt::PK::RSA-&gt;new(&#39;Bob_priv_rsa1.der&#39;);
 my $pt = $priv-&gt;decrypt($ct);

 #Signature: Alice
 my $priv = Crypt::PK::RSA-&gt;new(&#39;Alice_priv_rsa1.der&#39;);
 my $sig = $priv-&gt;sign_message($message);
 #
 #Signature: Bob (received $message + $sig)
 my $pub = Crypt::PK::RSA-&gt;new(&#39;Alice_pub_rsa1.der&#39;);
 $pub-&gt;verify_message($sig, $message) or die &quot;ERROR&quot;;

 #Key generation
 my $pk = Crypt::PK::RSA-&gt;new();
 $pk-&gt;generate_key(256, 65537);
 my $private_der = $pk-&gt;export_key_der(&#39;private&#39;);
 my $public_der = $pk-&gt;export_key_der(&#39;public&#39;);
 my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;);
 my $public_pem = $pk-&gt;export_key_pem(&#39;public&#39;);

 ### Functional interface

 #Encryption: Alice
 my $ct = rsa_encrypt(&#39;Bob_pub_rsa1.der&#39;, &quot;secret message&quot;);
 #Encryption: Bob (received ciphertext $ct)
 my $pt = rsa_decrypt(&#39;Bob_priv_rsa1.der&#39;, $ct);

 #Signature: Alice
 my $sig = rsa_sign_message(&#39;Alice_priv_rsa1.der&#39;, $message);
 #Signature: Bob (received $message + $sig)
 rsa_verify_message(&#39;Alice_pub_rsa1.der&#39;, $sig, $message) or die &quot;ERROR&quot;;</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>The module provides a full featured RSA implementation.</p>

<h1 id="METHODS">METHODS</h1>

<h2 id="new">new</h2>

<pre><code>  my $pk = Crypt::PK::RSA-&gt;new();
  #or
  my $pk = Crypt::PK::RSA-&gt;new($priv_or_pub_key_filename);
  #or
  my $pk = Crypt::PK::RSA-&gt;new(\$buffer_containing_priv_or_pub_key);</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code>  my $pk = Crypt::PK::RSA-&gt;new($priv_pem_key_filename, $password);
  #or
  my $pk = Crypt::PK::RSA-&gt;new(\$buffer_containing_priv_pem_key, $password);</code></pre>

<h2 id="generate_key">generate_key</h2>

<p>Uses Yarrow-based cryptographically strong random number generator seeded with random data taken from <code>/dev/random</code> (UNIX) or <code>CryptGenRandom</code> (Win32).</p>

<pre><code> $pk-&gt;generate_key($size, $e);
 # $size .. key size: 128-512 bytes (DEFAULT is 256)
 # $e ..... exponent: 3, 17, 257 or 65537 (DEFAULT is 65537)</code></pre>

<h2 id="import_key">import_key</h2>

<p>Loads private or public key in DER or PEM format.</p>

<pre><code>  $pk-&gt;import_key($priv_or_pub_key_filename);
  #or
  $pk-&gt;import_key(\$buffer_containing_priv_or_pub_key);</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code>  $pk-&gt;import_key($pem_filename, $password);
  #or
  $pk-&gt;import_key(\$buffer_containing_pem_key, $password);</code></pre>

<p>Loading private or public keys form perl hash:</p>

<pre><code> $pk-&gt;import_key($hashref);

 # the $hashref is either a key exported via key2hash
 $pk-&gt;import_key({
   e  =&gt; &quot;10001&quot;, #public exponent
   d  =&gt; &quot;9ED5C3D3F866E06957CA0E9478A273C39BBDA4EEAC5B...&quot;, #private exponent
   N  =&gt; &quot;D0A5CCCAE03DF9C2F5C4C8C0CE840D62CDE279990DC6...&quot;, #modulus
   p  =&gt; &quot;D3EF0028FFAB508E2773C659E428A80FB0E9211346B4...&quot;, #p factor of N
   q  =&gt; &quot;FC07E46B163CAB6A83B8E467D169534B2077DCDEECAE...&quot;, #q factor of N
   qP =&gt; &quot;88C6D406F833DF73C8B734548E0385261AD51F4187CF...&quot;, #1/q mod p CRT param
   dP =&gt; &quot;486F142FEF0A1F53269AC43D2EE4D263E2841B60DA36...&quot;, #d mod (p - 1) CRT param
   dQ =&gt; &quot;4597284B2968B72C4212DB7E8F24360B987B80514DA9...&quot;, #d mod (q - 1) CRT param
 });

 # or a hash with items corresponding to JWK (JSON Web Key)
 $pk-&gt;import_key({
 {
   kty =&gt; &quot;RSA&quot;,
   n   =&gt; &quot;0vx7agoebGcQSuuPiLJXZpt...eZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw&quot;,
   e   =&gt; &quot;AQAB&quot;,
   d   =&gt; &quot;X4cTteJY_gn4FYPsXB8rdXi...FLN5EEaG6RoVH-HLKD9Mdx5ooGURknhnrRwUkC7h5fJLMWbFAKLWY2v7B6NqSzUvx0_YSf&quot;,
   p   =&gt; &quot;83i-7IvMGXoMXCskv73TKr8...Z27zvoj6pbUQyLPBQxtPnwD20-60eTmD2ujMt5PoMrm8RmNhVWtjjMmMjOpSicFHjXOuVI&quot;,
   q   =&gt; &quot;3dfOR9cuYq-0S-mkFLzgItg...q3hWeMuG0ouqnb3obLyuqjVZQ1dIrdgTnCdYzBcOW5r37AFXjift_NGiovonzhKpoVVS78&quot;,
   dp  =&gt; &quot;G4sPXkc6Ya9y8oJW9_ILj4...zi_H7TkS8x5SdX3oE0oiYwxIiemTAu0UOa5pgFGyJ4c8t2VF40XRugKTP8akhFo5tA77Qe&quot;,
   dq  =&gt; &quot;s9lAH9fggBsoFR8Oac2R_E...T2kGOhvIllTE1efA6huUvMfBcpn8lqW6vzzYY5SSF7pMd_agI3G8IbpBUb0JiraRNUfLhc&quot;,
   qi  =&gt; &quot;GyM_p6JrXySiz1toFgKbWV...4ypu9bMWx3QJBfm0FoYzUIZEVEcOqwmRN81oDAaaBk0KWGDjJHDdDmFW3AN7I-pux_mHZG&quot;,
 });</code></pre>

<p>Supported key formats:</p>

<pre><code> # all formats can be loaded from a file
 my $pk = Crypt::PK::RSA-&gt;new($filename);

 # or from a buffer containing the key
 my $pk = Crypt::PK::RSA-&gt;new(\$buffer_with_key);</code></pre>

<ul>

<li><p>RSA public keys</p>

<pre><code> -----BEGIN PUBLIC KEY-----
 MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHlYKg9DeHB3/dY1D9WCyJTnl5
 vEzAXpUOL9tDtdPUl96brIbbdMLooO1hKjsq98kLs1q4vOn/pxvzk0BRwhiu7Vvb
 VUjAn/2HHDDL0U1utqqlMJhaffeLI3HEq5o/lSMFY7sSkZU/E4YX1yqAN0SE7xfK
 B2uzcNq60sMIfp6siQIDAQAB
 -----END PUBLIC KEY-----</code></pre>

</li>
<li><p>RSA private keys</p>

<pre><code> -----BEGIN RSA PRIVATE KEY-----
 MIICXQIBAAKBgQDHlYKg9DeHB3/dY1D9WCyJTnl5vEzAXpUOL9tDtdPUl96brIbb
 dMLooO1hKjsq98kLs1q4vOn/pxvzk0BRwhiu7VvbVUjAn/2HHDDL0U1utqqlMJha
 ffeLI3HEq5o/lSMFY7sSkZU/E4YX1yqAN0SE7xfKB2uzcNq60sMIfp6siQIDAQAB
 AoGBAI5+GgNcGQDYw9uF+t7FwxZM5sGZRJrbbEPyuvL+sDxKKW6voKCyHi4EJzaF
 9jRZMDqgVJcsmUwjPPuMGBHHJ+MI5Zb3L0jbZkyx8u+U5gf88oy9eZmfGOjmHcMB
 oCgzyoLmJETuyADg2onLanuY3jggFb3tq/jimKjO8xM2R6zhAkEA7uXWWyJI9cCN
 zrVt5R5v6oosjZ4r5VILGMqBRLrzfTvH+WDMK6Rl/2MHE+YDeLajzunaM8qY2456
 GTYEXQsIdQJBANXfMEtXocSdPtoVj3ME8Do/0r+ApgTdcDPCwXOzkmkEJW/UFMSn
 b8CYF5G6sZQN9L5z3s2nvi55PaFV8Q0LMUUCQBh9GvIQm6YFbQPpeTBpZFOIgnSp
 6BoDxPtvlryy5U7LF/6qO4OlwIbjYdBaXbS8FCKbujBg7jZjboSzEtNu1BkCQDGT
 w0Yz0jQZn3A+fzpScr2N/fSWheWqz0+wXdfMUKw3YdZCe236wlUK7KvDc1a2xX1A
 ru1NbTCoujikC3TSm2ECQQDKQshchJlZJmFv9vCFQlGCA/EX+4406xvOOiixbPYC
 pIB4Ee2cmvEdAqSaOjrvgs5zvaCCFBO0MecPStCAxUX6
 -----END RSA PRIVATE KEY-----</code></pre>

</li>
<li><p>RSA private keys in password protected PEM format</p>

<pre><code> -----BEGIN RSA PRIVATE KEY-----
 Proc-Type: 4,ENCRYPTED
 DEK-Info: DES-EDE3-CBC,4D697440FF5AEF18

 C09H49Gn99o8b8O2r4+Hqao4r3udvC+QSSfsk20sXatyuZSEmbhyqKAB+13NRj+3
 KIsRTqnL9VkeibIGgLHuekOFKAqeSVZ0PmR4bGWEFxUPAYUvg9N9pIa6hGtNZG+y
 TEpOAfFITb1pbHQhp3j8y7qmKc5kY5LrZSFE8WwA24NTG773E07wJgRxKDkXNGOl
 kki6oYArNEps0DdtHFxzgdRg0+yaotXuFJRuC5V4YzKGG/oSRcgYyXKTwCndb3xt
 aHgI2WprQAPg+qOpLABzoi7bEjCqbHWrwkvnAngylbim2Uyvw1e1xKnzlgIHU7pv
 e/J+s00pTItfqW1IpY2mh4C9nkfkfVKBKaAv7jO0s6aPySATqsdlrzv2kpF6Ub4J
 kgaZDOfZ4K3qkyAYVLWcQeDqg4glv9Ah2J05bTm4qrIMmthYnThyQlGvcjUfCMXs
 0t+mEQbsRY7xKt0o6HzzvQlJ+JsFlLORoslAubJX9iLqpEdnlrj1lD9bo6uIClZ5
 5+aoLcAyz1D4OsauuP5i8VFu+Is+QG4SN/vHVuArjkqi3VpLwSAjNDY+KWbq042l
 CqlM2mwm6FIGUZQFxiLHJD7WDmk1xmae++m+XG9CEDTfrUQ5v+l0O6BTrl80XUfU
 w3gzAWbSjz3UK0FpKeABVFPE9fjNP9fTcS6qL5YJWBPflwxCAbVgsBOW4bOMpDGK
 BJDQTeShWn4BlYCe/vgThI9ERdgZhRz4NcFeDgVA/CqQzVqptvz4PSqH46fqUN2n
 4PtJgKE5cASYUBuAjlD71FecSVVM/OTzL1uxYzXBilzvVn2vSHgo9g==
 -----END RSA PRIVATE KEY-----</code></pre>

</li>
<li><p>PKCS#8 encoded private keys</p>

<pre><code> -----BEGIN PRIVATE KEY-----
 MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBANPN17xW4EkH5PXG
 1i/i3rE1EXFcCHyxmz95VRBDs1p3MuYf9mxntbfYAmuzS3KrRWh3IyX/Eh80N/v9
 OXPlwZbVqSTX+L3pCEJtRtsWn0zmswGThjMZiwle0oWuap63L35F1QN8EDaSPSBC
 yGELNRr6rwVYq0w5b+LOcaCZ+/H1AgMBAAECgYEApfu3aGpww+rC3HUhX0+ckyTy
 cXLdV9LbxidwqRlVEb0+DyfXNucjelp2sy5EHy3na9GJovo8mmWSxhCRGKliRkQ6
 XgrEMZdCSaWI2AazuHAGlUJRFEVkvdla3AuBAn6y0YdDp/3kbg0yahmKyD8Gq74z
 nUYbDL3R5JtR2Ad/KlUCQQDvSEICTHbO/BF7hVmlKRYZSNHKEPrv8X/OlppS14Kv
 QRwc+CZ5+l6T1Y+l5cHJQUXrXZoWS1K741TXdUhjjUd7AkEA4pod804Ex8sttdWi
 pHMfeyj+IbPAk5XnBc91jT7AYIeL8ccjtfl99xhMsGFaxrh3wA/4SGEvwzWkbxcq
 H8G5TwJAKNG+0P2SVwURRm0dOdukdXPCtiHnbP9Zujhe4zr4hEUrMpXymmRntfh8
 pORpBpgoAVraams3Fe5WDttnGfSD+QJAOOC6V9HjfUrQhG3FT0XeRwm5EDiQQ/tC
 a8DxHqz7mL8tL1ju68ReC+G7jiJBqNOwqzLW/UP3uyYByiikWChGHQJAHUau7jIM
 45ErO096n94Vh95p76ANxOroWszOt39TyvJOykIfoPwFagLrBWV9Jjos2/D54KE+
 fyoy4t3yHT+/nw==
 -----END PRIVATE KEY-----</code></pre>

</li>
<li><p>PKCS#8 encrypted private keys - password protected keys (supported since: CryptX-0.062)</p>

<pre><code> -----BEGIN ENCRYPTED PRIVATE KEY-----
 MIICojAcBgoqhkiG9w0BDAEDMA4ECCQk+Rr1yzzcAgIIAASCAoD/mgpUFjxxM/Ty
 Yt+NeT0Fo4echgoGksqs6+rYhO16oshG664emZfkuNoFGGzJ38X6GVuqIXhlPnYQ
 biKvL37dN/KnoGytFHq9Wnk8dDwjGHPtwajhW5WuIV3NuhW/AO1PF/cRZKFjWrPt
 NWY5CrpfH6t6zojoe+5uyXpH29lQy4OqvSRdPIt/12UcB+tzV7XzSWEuXh8HAi8a
 sYUu6tuCFnq4GrD2ffM4KWFmL5GqBAwN6m0KkyrNni9XT+RaA6zEhv/lVcwg2esa
 4/EzRs0ixzzZDKaml8oCMl9RHtFAbQmdlfV7Ip4rGK9BwY6UFiDMIVru6HynOVQK
 vvZ+j//bgO+3ubrv7psX+vC9Fy/MoH2Tc7MIwDN/QVTciPZlzjWBnBNxMfeFKtEn
 d7NFiapgfLuRQIiDTMrW/clcqvO54NphxhrcgUEoxos4twKZARntqPZHtf8nEM2x
 2sEF5kI65aEF/5Yy16qvP0vZAA2B1kcIdXZ8XLZCp4c3olhkIrmgUpo1gyFXdCoC
 7dT5Cz7/YLkq5hkcFrtp4V9BZMR24fSttc4p24N5xuZ+JneGnGkLX6B+nJAtm9vw
 bZA6P+23GI0qeMzL3HJXwCOTSsWfm/H9W5+2Zmw851aAmE+pZLni/pk3e3iNSWgs
 946x/doA5O0uCFsU7oxme+WAIp2SjhxGoe808Lf1CCFMPboFi1O/E0NsX8SIEX+i
 U+UHi4kxZqVkr3Q5SB/9kiSv8K1bE787yueQOT/dsTYYaMsjAbkEZo0o/47F32T6
 A2ioXHOV/pr5zNHqE5tL+qKEcLYbAUF1O+WvmdqYz+vHQjRQBatAqTmncvLDYr/j
 1HPwZX2d
 -----END ENCRYPTED PRIVATE KEY-----</code></pre>

</li>
<li><p>RSA public key from X509 certificate</p>

<pre><code> -----BEGIN CERTIFICATE-----
 MIIC8zCCAdugAwIBAgIJAPi+LvMU3uGWMA0GCSqGSIb3DQEBCwUAMBAxDjAMBgNV
 BAMMBXBva3VzMB4XDTE3MDcxNDE0MTAyMFoXDTIwMDQwOTE0MTAyMFowEDEOMAwG
 A1UEAwwFcG9rdXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDCQima
 SUIMIdz5uVevzcScbcj06xs1OLaFKUoPJ8v+xP6Ut61BQhAvc8GYuw2uRx223hZC
 r3HYLfSdWIfmOIAtlL8cPYPVoSivJtpSGE6fBG1tlBjVgXWRmJGR/oxx6Y5QDwcB
 Q4GZKga8TtHQoY5idZuatYOFZGfMIcIUC0Uoda+YSypnw7A90F/JvlpcTUh3Fnem
 VinqEA6XOegU9dCZk/29sXqauBjbdGihh8DvpklOhY16eQoiR3909AywQ0KUmI+R
 Sa9E8oIsmUDetFuXEvana+sD3y42tU+cd2nhBPRETbSXPcum0B3uF4yKgweuJy5D
 cvtVQIFVkkh4+AWNAgMBAAGjUDBOMB0GA1UdDgQWBBSS6V5PVGyN92NoB0AVLcOb
 pzR3SzAfBgNVHSMEGDAWgBSS6V5PVGyN92NoB0AVLcObpzR3SzAMBgNVHRMEBTAD
 AQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBIszrBjoJ39axsS6Btbvwvo8vAmgiSWsav
 7AmjXOAwknHPaCcDmrdOys5POD0DNRwNeRsnxFiZ/UL8Vmj2JGDLgAw+/v32MwfX
 Ig7m+oIbO8KqDzlYvS5kd3suJ5C21hHy1/JUtfofZLovZH7ZRzhTAoRvCYaodW90
 2o8ZqmyCdcXPzjFmoJ2xYzs/Sf8/E1cHfb+4HjOpeRnKxDvG0gwWzcsXpUrw2pNO
 Oztj6Rd0THNrf/anIeYVtAHX4aqZA8Kbv2TyJd+9g78usFw1cn+8vfmilm6Pn0DQ
 a+I5GyGd7BJI8wYuWqIStzvrJHbQQaNrSk7hgjWYiYlcsPh6w2QP
 -----END CERTIFICATE-----</code></pre>

</li>
<li><p>SSH public RSA keys</p>

<pre><code> ssh-rsa AAAAB3NzaC1yc2EAAAADAQA...6mdYs5iJNGu/ltUdc=</code></pre>

</li>
<li><p>SSH public RSA keys (RFC-4716 format)</p>

<pre><code> ---- BEGIN SSH2 PUBLIC KEY ----
 Comment: &quot;768-bit RSA, converted from OpenSSH&quot;
 AAAAB3NzaC1yc2EAAAADAQABAAAAYQDYebeGQFCnlQiNRE7r9UEbjr+DQMTdw1ZHGB2w6x
 D/DzKem8761GdCpqsLrGaw2D7aSIoP1B5Sz870YoVWHn6Ao7Hvm17V3Kxfn4B01GNQTM5+
 L26mdYs5iJNGu/ltUdc=
 ---- END SSH2 PUBLIC KEY ----</code></pre>

</li>
<li><p>RSA private keys in JSON Web Key (JWK) format</p>

<p>See <a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-key">http://tools.ietf.org/html/draft-ietf-jose-json-web-key</a></p>

<pre><code> {
   &quot;kty&quot;:&quot;RSA&quot;,
   &quot;n&quot;:&quot;0vx7agoebGcQSuuPiLJXZpt...eZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw&quot;,
   &quot;e&quot;:&quot;AQAB&quot;,
   &quot;d&quot;:&quot;X4cTteJY_gn4FYPsXB8rdXi...FLN5EEaG6RoVH-HLKD9Mdx5ooGURknhnrRwUkC7h5fJLMWbFAKLWY2v7B6NqSzUvx0_YSf&quot;,
   &quot;p&quot;:&quot;83i-7IvMGXoMXCskv73TKr8...Z27zvoj6pbUQyLPBQxtPnwD20-60eTmD2ujMt5PoMrm8RmNhVWtjjMmMjOpSicFHjXOuVI&quot;,
   &quot;q&quot;:&quot;3dfOR9cuYq-0S-mkFLzgItg...q3hWeMuG0ouqnb3obLyuqjVZQ1dIrdgTnCdYzBcOW5r37AFXjift_NGiovonzhKpoVVS78&quot;,
   &quot;dp&quot;:&quot;G4sPXkc6Ya9y8oJW9_ILj4...zi_H7TkS8x5SdX3oE0oiYwxIiemTAu0UOa5pgFGyJ4c8t2VF40XRugKTP8akhFo5tA77Qe&quot;,
   &quot;dq&quot;:&quot;s9lAH9fggBsoFR8Oac2R_E...T2kGOhvIllTE1efA6huUvMfBcpn8lqW6vzzYY5SSF7pMd_agI3G8IbpBUb0JiraRNUfLhc&quot;,
   &quot;qi&quot;:&quot;GyM_p6JrXySiz1toFgKbWV...4ypu9bMWx3QJBfm0FoYzUIZEVEcOqwmRN81oDAaaBk0KWGDjJHDdDmFW3AN7I-pux_mHZG&quot;,
 }</code></pre>

<p><b>BEWARE:</b> For JWK support you need to have <a href="../../../../lib/perl5/5.26.3/JSON/PP.html">JSON::PP</a>, <a>JSON::XS</a> or <a>Cpanel::JSON::XS</a> module.</p>

</li>
<li><p>RSA public keys in JSON Web Key (JWK) format</p>

<pre><code> {
   &quot;kty&quot;:&quot;RSA&quot;,
   &quot;n&quot;: &quot;0vx7agoebGcQSuuPiLJXZp...tN9nndrQmbXEps2aiAFbWhM78LhWx4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECP&quot;,
   &quot;e&quot;:&quot;AQAB&quot;,
 }</code></pre>

<p><b>BEWARE:</b> For JWK support you need to have <a href="../../../../lib/perl5/5.26.3/JSON/PP.html">JSON::PP</a>, <a>JSON::XS</a> or <a>Cpanel::JSON::XS</a> module.</p>

</li>
</ul>

<h2 id="export_key_der">export_key_der</h2>

<pre><code> my $private_der = $pk-&gt;export_key_der(&#39;private&#39;);
 #or
 my $public_der = $pk-&gt;export_key_der(&#39;public&#39;);</code></pre>

<h2 id="export_key_pem">export_key_pem</h2>

<pre><code> my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;);
 #or
 my $public_pem = $pk-&gt;export_key_pem(&#39;public&#39;);
 #or
 my $public_pem = $pk-&gt;export_key_pem(&#39;public_x509&#39;);</code></pre>

<p>With parameter <code>&#39;public&#39;</code> uses header and footer lines:</p>

<pre><code>  -----BEGIN RSA PUBLIC KEY------
  -----END RSA PUBLIC KEY------</code></pre>

<p>With parameter <code>&#39;public_x509&#39;</code> uses header and footer lines:</p>

<pre><code>  -----BEGIN PUBLIC KEY------
  -----END PUBLIC KEY------</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code> my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;, $password);
 #or
 my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;, $password, $cipher);

 # supported ciphers: &#39;DES-CBC&#39;
 #                    &#39;DES-EDE3-CBC&#39;
 #                    &#39;SEED-CBC&#39;
 #                    &#39;CAMELLIA-128-CBC&#39;
 #                    &#39;CAMELLIA-192-CBC&#39;
 #                    &#39;CAMELLIA-256-CBC&#39;
 #                    &#39;AES-128-CBC&#39;
 #                    &#39;AES-192-CBC&#39;
 #                    &#39;AES-256-CBC&#39; (DEFAULT)</code></pre>

<h2 id="export_key_jwk">export_key_jwk</h2>

<p><i>Since: CryptX-0.022</i></p>

<p>Exports public/private keys as a JSON Web Key (JWK).</p>

<pre><code> my $private_json_text = $pk-&gt;export_key_jwk(&#39;private&#39;);
 #or
 my $public_json_text = $pk-&gt;export_key_jwk(&#39;public&#39;);</code></pre>

<p>Also exports public/private keys as a perl HASH with JWK structure.</p>

<pre><code> my $jwk_hash = $pk-&gt;export_key_jwk(&#39;private&#39;, 1);
 #or
 my $jwk_hash = $pk-&gt;export_key_jwk(&#39;public&#39;, 1);</code></pre>

<p><b>BEWARE:</b> For JWK support you need to have <a href="../../../../lib/perl5/5.26.3/JSON/PP.html">JSON::PP</a>, <a>JSON::XS</a> or <a>Cpanel::JSON::XS</a> module.</p>

<h2 id="export_key_jwk_thumbprint">export_key_jwk_thumbprint</h2>

<p><i>Since: CryptX-0.031</i></p>

<p>Exports the key&#39;s JSON Web Key Thumbprint as a string.</p>

<p>If you don&#39;t know what this is, see RFC 7638 <a href="https://tools.ietf.org/html/rfc7638">https://tools.ietf.org/html/rfc7638</a>.</p>

<pre><code> my $thumbprint = $pk-&gt;export_key_jwk_thumbprint(&#39;SHA256&#39;);</code></pre>

<h2 id="encrypt">encrypt</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($pub_key_filename);
 my $ct = $pk-&gt;encrypt($message);
 #or
 my $ct = $pk-&gt;encrypt($message, $padding);
 #or
 my $ct = $pk-&gt;encrypt($message, &#39;oaep&#39;, $hash_name, $lparam);

 # $padding .................... &#39;oaep&#39; (DEFAULT), &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $hash_name (only for oaep) .. &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $lparam (only for oaep) ..... DEFAULT is empty string</code></pre>

<h2 id="decrypt">decrypt</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($priv_key_filename);
 my $pt = $pk-&gt;decrypt($ciphertext);
 #or
 my $pt = $pk-&gt;decrypt($ciphertext, $padding);
 #or
 my $pt = $pk-&gt;decrypt($ciphertext, &#39;oaep&#39;, $hash_name, $lparam);

 # $padding .................... &#39;oaep&#39; (DEFAULT), &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $hash_name (only for oaep) .. &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $lparam (only for oaep) ..... DEFAULT is empty string</code></pre>

<h2 id="sign_message">sign_message</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($priv_key_filename);
 my $signature = $priv-&gt;sign_message($message);
 #or
 my $signature = $priv-&gt;sign_message($message, $hash_name);
 #or
 my $signature = $priv-&gt;sign_message($message, $hash_name, $padding);
 #or
 my $signature = $priv-&gt;sign_message($message, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="verify_message">verify_message</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($pub_key_filename);
 my $valid = $pub-&gt;verify_message($signature, $message);
 #or
 my $valid = $pub-&gt;verify_message($signature, $message, $hash_name);
 #or
 my $valid = $pub-&gt;verify_message($signature, $message, $hash_name, $padding);
 #or
 my $valid = $pub-&gt;verify_message($signature, $message, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="sign_hash">sign_hash</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($priv_key_filename);
 my $signature = $priv-&gt;sign_hash($message_hash);
 #or
 my $signature = $priv-&gt;sign_hash($message_hash, $hash_name);
 #or
 my $signature = $priv-&gt;sign_hash($message_hash, $hash_name, $padding);
 #or
 my $signature = $priv-&gt;sign_hash($message_hash, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="verify_hash">verify_hash</h2>

<pre><code> my $pk = Crypt::PK::RSA-&gt;new($pub_key_filename);
 my $valid = $pub-&gt;verify_hash($signature, $message_hash);
 #or
 my $valid = $pub-&gt;verify_hash($signature, $message_hash, $hash_name);
 #or
 my $valid = $pub-&gt;verify_hash($signature, $message_hash, $hash_name, $padding);
 #or
 my $valid = $pub-&gt;verify_hash($signature, $message_hash, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="is_private">is_private</h2>

<pre><code> my $rv = $pk-&gt;is_private;
 # 1 .. private key loaded
 # 0 .. public key loaded
 # undef .. no key loaded</code></pre>

<h2 id="size">size</h2>

<pre><code> my $size = $pk-&gt;size;
 # returns key size in bytes or undef if no key loaded</code></pre>

<h2 id="key2hash">key2hash</h2>

<pre><code> my $hash = $pk-&gt;key2hash;

 # returns hash like this (or undef if no key loaded):
 {
   type =&gt; 1,   # integer: 1 .. private, 0 .. public
   size =&gt; 256, # integer: key size in bytes
   # all the rest are hex strings
   e  =&gt; &quot;10001&quot;, #public exponent
   d  =&gt; &quot;9ED5C3D3F866E06957CA0E9478A273C39BBDA4EEAC5B...&quot;, #private exponent
   N  =&gt; &quot;D0A5CCCAE03DF9C2F5C4C8C0CE840D62CDE279990DC6...&quot;, #modulus
   p  =&gt; &quot;D3EF0028FFAB508E2773C659E428A80FB0E9211346B4...&quot;, #p factor of N
   q  =&gt; &quot;FC07E46B163CAB6A83B8E467D169534B2077DCDEECAE...&quot;, #q factor of N
   qP =&gt; &quot;88C6D406F833DF73C8B734548E0385261AD51F4187CF...&quot;, #1/q mod p CRT param
   dP =&gt; &quot;486F142FEF0A1F53269AC43D2EE4D263E2841B60DA36...&quot;, #d mod (p - 1) CRT param
   dQ =&gt; &quot;4597284B2968B72C4212DB7E8F24360B987B80514DA9...&quot;, #d mod (q - 1) CRT param
 }</code></pre>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<h2 id="rsa_encrypt">rsa_encrypt</h2>

<p>RSA based encryption. See method <a href="#encrypt">&quot;encrypt&quot;</a> below.</p>

<pre><code> my $ct = rsa_encrypt($pub_key_filename, $message);
 #or
 my $ct = rsa_encrypt(\$buffer_containing_pub_key, $message);
 #or
 my $ct = rsa_encrypt($pub_key, $message, $padding);
 #or
 my $ct = rsa_encrypt($pub_key, $message, &#39;oaep&#39;, $hash_name, $lparam);

 # $padding .................... &#39;oaep&#39; (DEFAULT), &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $hash_name (only for oaep) .. &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $lparam (only for oaep) ..... DEFAULT is empty string</code></pre>

<h2 id="rsa_decrypt">rsa_decrypt</h2>

<p>RSA based decryption. See method <a href="#decrypt">&quot;decrypt&quot;</a> below.</p>

<pre><code> my $pt = rsa_decrypt($priv_key_filename, $ciphertext);
 #or
 my $pt = rsa_decrypt(\$buffer_containing_priv_key, $ciphertext);
 #or
 my $pt = rsa_decrypt($priv_key, $ciphertext, $padding);
 #or
 my $pt = rsa_decrypt($priv_key, $ciphertext, &#39;oaep&#39;, $hash_name, $lparam);

 # $padding .................... &#39;oaep&#39; (DEFAULT), &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $hash_name (only for oaep) .. &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $lparam (only for oaep) ..... DEFAULT is empty string</code></pre>

<h2 id="rsa_sign_message">rsa_sign_message</h2>

<p>Generate RSA signature. See method <a href="#sign_message">&quot;sign_message&quot;</a> below.</p>

<pre><code> my $sig = rsa_sign_message($priv_key_filename, $message);
 #or
 my $sig = rsa_sign_message(\$buffer_containing_priv_key, $message);
 #or
 my $sig = rsa_sign_message($priv_key, $message, $hash_name);
 #or
 my $sig = rsa_sign_message($priv_key, $message, $hash_name, $padding);
 #or
 my $sig = rsa_sign_message($priv_key, $message, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="rsa_verify_message">rsa_verify_message</h2>

<p>Verify RSA signature. See method <a href="#verify_message">&quot;verify_message&quot;</a> below.</p>

<pre><code> rsa_verify_message($pub_key_filename, $signature, $message) or die &quot;ERROR&quot;;
 #or
 rsa_verify_message(\$buffer_containing_pub_key, $signature, $message) or die &quot;ERROR&quot;;
 #or
 rsa_verify_message($pub_key, $signature, $message, $hash_name) or die &quot;ERROR&quot;;
 #or
 rsa_verify_message($pub_key, $signature, $message, $hash_name, $padding) or die &quot;ERROR&quot;;
 #or
 rsa_verify_message($pub_key, $signature, $message, $hash_name, &#39;pss&#39;, $saltlen) or die &quot;ERROR&quot;;

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="rsa_sign_hash">rsa_sign_hash</h2>

<p>Generate RSA signature. See method <a href="#sign_hash">&quot;sign_hash&quot;</a> below.</p>

<pre><code> my $sig = rsa_sign_hash($priv_key_filename, $message_hash);
 #or
 my $sig = rsa_sign_hash(\$buffer_containing_priv_key, $message_hash);
 #or
 my $sig = rsa_sign_hash($priv_key, $message_hash, $hash_name);
 #or
 my $sig = rsa_sign_hash($priv_key, $message_hash, $hash_name, $padding);
 #or
 my $sig = rsa_sign_hash($priv_key, $message_hash, $hash_name, &#39;pss&#39;, $saltlen);

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h2 id="rsa_verify_hash">rsa_verify_hash</h2>

<p>Verify RSA signature. See method <a href="#verify_hash">&quot;verify_hash&quot;</a> below.</p>

<pre><code> rsa_verify_hash($pub_key_filename, $signature, $message_hash) or die &quot;ERROR&quot;;
 #or
 rsa_verify_hash(\$buffer_containing_pub_key, $signature, $message_hash) or die &quot;ERROR&quot;;
 #or
 rsa_verify_hash($pub_key, $signature, $message_hash, $hash_name) or die &quot;ERROR&quot;;
 #or
 rsa_verify_hash($pub_key, $signature, $message_hash, $hash_name, $padding) or die &quot;ERROR&quot;;
 #or
 rsa_verify_hash($pub_key, $signature, $message_hash, $hash_name, &#39;pss&#39;, $saltlen) or die &quot;ERROR&quot;;

 # $hash_name ............... &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest
 # $padding ................. &#39;pss&#39; (DEFAULT) or &#39;v1.5&#39; or &#39;none&#39; (INSECURE)
 # $saltlen (only for pss) .. DEFAULT is 12</code></pre>

<h1 id="OpenSSL-interoperability">OpenSSL interoperability</h1>

<pre><code> ### let&#39;s have:
 # RSA private key in PEM format - rsakey.priv.pem
 # RSA public key in PEM format  - rsakey.pub.pem
 # data file to be signed or encrypted - input.data</code></pre>

<h2 id="Encrypt-by-OpenSSL-decrypt-by-Crypt::PK::RSA">Encrypt by OpenSSL, decrypt by Crypt::PK::RSA</h2>

<p>Create encrypted file (from commandline):</p>

<pre><code> openssl rsautl -encrypt -inkey rsakey.pub.pem -pubin -out input.encrypted.rsa -in input.data</code></pre>

<p>Decrypt file (Perl code):</p>

<pre><code>  use Crypt::PK::RSA;
  use Crypt::Misc &#39;read_rawfile&#39;;

  my $pkrsa = Crypt::PK::RSA-&gt;new(&quot;rsakey.priv.pem&quot;);
  my $encfile = read_rawfile(&quot;input.encrypted.rsa&quot;);
  my $plaintext = $pkrsa-&gt;decrypt($encfile, &#39;v1.5&#39;);
  print $plaintext;</code></pre>

<h2 id="Encrypt-by-Crypt::PK::RSA-decrypt-by-OpenSSL">Encrypt by Crypt::PK::RSA, decrypt by OpenSSL</h2>

<p>Create encrypted file (Perl code):</p>

<pre><code>  use Crypt::PK::RSA;
  use Crypt::Misc &#39;write_rawfile&#39;;

  my $plaintext = &#39;secret message&#39;;
  my $pkrsa = Crypt::PK::RSA-&gt;new(&quot;rsakey.pub.pem&quot;);
  my $encrypted = $pkrsa-&gt;encrypt($plaintext, &#39;v1.5&#39;);
  write_rawfile(&quot;input.encrypted.rsa&quot;, $encrypted);</code></pre>

<p>Decrypt file (from commandline):</p>

<pre><code> openssl rsautl -decrypt -inkey rsakey.priv.pem -in input.encrypted.rsa</code></pre>

<h2 id="Sign-by-OpenSSL-verify-by-Crypt::PK::RSA">Sign by OpenSSL, verify by Crypt::PK::RSA</h2>

<p>Create signature (from commandline):</p>

<pre><code> openssl dgst -sha1 -sign rsakey.priv.pem -out input.sha1-rsa.sig input.data</code></pre>

<p>Verify signature (Perl code):</p>

<pre><code> use Crypt::PK::RSA;
 use Crypt::Digest &#39;digest_file&#39;;
 use Crypt::Misc &#39;read_rawfile&#39;;

 my $pkrsa = Crypt::PK::RSA-&gt;new(&quot;rsakey.pub.pem&quot;);
 my $signature = read_rawfile(&quot;input.sha1-rsa.sig&quot;);
 my $valid = $pkrsa-&gt;verify_hash($signature, digest_file(&quot;SHA1&quot;, &quot;input.data&quot;), &quot;SHA1&quot;, &quot;v1.5&quot;);
 print $valid ? &quot;SUCCESS&quot; : &quot;FAILURE&quot;;</code></pre>

<h2 id="Sign-by-Crypt::PK::RSA-verify-by-OpenSSL">Sign by Crypt::PK::RSA, verify by OpenSSL</h2>

<p>Create signature (Perl code):</p>

<pre><code> use Crypt::PK::RSA;
 use Crypt::Digest &#39;digest_file&#39;;
 use Crypt::Misc &#39;write_rawfile&#39;;

 my $pkrsa = Crypt::PK::RSA-&gt;new(&quot;rsakey.priv.pem&quot;);
 my $signature = $pkrsa-&gt;sign_hash(digest_file(&quot;SHA1&quot;, &quot;input.data&quot;), &quot;SHA1&quot;, &quot;v1.5&quot;);
 write_rawfile(&quot;input.sha1-rsa.sig&quot;, $signature);</code></pre>

<p>Verify signature (from commandline):</p>

<pre><code> openssl dgst -sha1 -verify rsakey.pub.pem -signature input.sha1-rsa.sig input.data</code></pre>

<h2 id="Keys-generated-by-Crypt::PK::RSA">Keys generated by Crypt::PK::RSA</h2>

<p>Generate keys (Perl code):</p>

<pre><code> use Crypt::PK::RSA;
 use Crypt::Misc &#39;write_rawfile&#39;;

 my $pkrsa = Crypt::PK::RSA-&gt;new;
 $pkrsa-&gt;generate_key(256, 65537);
 write_rawfile(&quot;rsakey.pub.der&quot;,  $pkrsa-&gt;export_key_der(&#39;public&#39;));
 write_rawfile(&quot;rsakey.priv.der&quot;, $pkrsa-&gt;export_key_der(&#39;private&#39;));
 write_rawfile(&quot;rsakey.pub.pem&quot;,  $pkrsa-&gt;export_key_pem(&#39;public_x509&#39;));
 write_rawfile(&quot;rsakey.priv.pem&quot;, $pkrsa-&gt;export_key_pem(&#39;private&#39;));
 write_rawfile(&quot;rsakey-passwd.priv.pem&quot;, $pkrsa-&gt;export_key_pem(&#39;private&#39;, &#39;secret&#39;));</code></pre>

<p>Use keys by OpenSSL:</p>

<pre><code> openssl rsa -in rsakey.priv.der -text -inform der
 openssl rsa -in rsakey.priv.pem -text
 openssl rsa -in rsakey-passwd.priv.pem -text -inform pem -passin pass:secret
 openssl rsa -in rsakey.pub.der -pubin -text -inform der
 openssl rsa -in rsakey.pub.pem -pubin -text</code></pre>

<h2 id="Keys-generated-by-OpenSSL">Keys generated by OpenSSL</h2>

<p>Generate keys:</p>

<pre><code> openssl genrsa -out rsakey.priv.pem 1024
 openssl rsa -in rsakey.priv.pem -out rsakey.priv.der -outform der
 openssl rsa -in rsakey.priv.pem -out rsakey.pub.pem -pubout
 openssl rsa -in rsakey.priv.pem -out rsakey.pub.der -outform der -pubout
 openssl rsa -in rsakey.priv.pem -passout pass:secret -des3 -out rsakey-passwd.priv.pem</code></pre>

<p>Load keys (Perl code):</p>

<pre><code> use Crypt::PK::RSA;

 my $pkrsa = Crypt::PK::RSA-&gt;new;
 $pkrsa-&gt;import_key(&quot;rsakey.pub.der&quot;);
 $pkrsa-&gt;import_key(&quot;rsakey.priv.der&quot;);
 $pkrsa-&gt;import_key(&quot;rsakey.pub.pem&quot;);
 $pkrsa-&gt;import_key(&quot;rsakey.priv.pem&quot;);
 $pkrsa-&gt;import_key(&quot;rsakey-passwd.priv.pem&quot;, &quot;secret&quot;);</code></pre>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<ul>

<li><p><a href="https://en.wikipedia.org/wiki/RSA_%28algorithm%29">https://en.wikipedia.org/wiki/RSA_%28algorithm%29</a></p>

</li>
</ul>


</body>

</html>


