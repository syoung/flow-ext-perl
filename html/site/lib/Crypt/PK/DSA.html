<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#generate_key">generate_key</a></li>
      <li><a href="#import_key">import_key</a></li>
      <li><a href="#export_key_der">export_key_der</a></li>
      <li><a href="#export_key_pem">export_key_pem</a></li>
      <li><a href="#encrypt">encrypt</a></li>
      <li><a href="#decrypt">decrypt</a></li>
      <li><a href="#sign_message">sign_message</a></li>
      <li><a href="#verify_message">verify_message</a></li>
      <li><a href="#sign_hash">sign_hash</a></li>
      <li><a href="#verify_hash">verify_hash</a></li>
      <li><a href="#is_private">is_private</a></li>
      <li><a href="#size">size</a></li>
      <li><a href="#size_q">size_q</a></li>
      <li><a href="#key2hash">key2hash</a></li>
    </ul>
  </li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#dsa_encrypt">dsa_encrypt</a></li>
      <li><a href="#dsa_decrypt">dsa_decrypt</a></li>
      <li><a href="#dsa_sign_message">dsa_sign_message</a></li>
      <li><a href="#dsa_verify_message">dsa_verify_message</a></li>
      <li><a href="#dsa_sign_hash">dsa_sign_hash</a></li>
      <li><a href="#dsa_verify_hash">dsa_verify_hash</a></li>
    </ul>
  </li>
  <li><a href="#OpenSSL-interoperability">OpenSSL interoperability</a>
    <ul>
      <li><a href="#Sign-by-OpenSSL-verify-by-Crypt::PK::DSA">Sign by OpenSSL, verify by Crypt::PK::DSA</a></li>
      <li><a href="#Sign-by-Crypt::PK::DSA-verify-by-OpenSSL">Sign by Crypt::PK::DSA, verify by OpenSSL</a></li>
      <li><a href="#Keys-generated-by-Crypt::PK::DSA">Keys generated by Crypt::PK::DSA</a></li>
      <li><a href="#Keys-generated-by-OpenSSL">Keys generated by OpenSSL</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Crypt::PK::DSA - Public key cryptography based on DSA</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> ### OO interface

 #Encryption: Alice
 my $pub = Crypt::PK::DSA-&gt;new(&#39;Bob_pub_dsa1.der&#39;);
 my $ct = $pub-&gt;encrypt(&quot;secret message&quot;);
 #
 #Encryption: Bob (received ciphertext $ct)
 my $priv = Crypt::PK::DSA-&gt;new(&#39;Bob_priv_dsa1.der&#39;);
 my $pt = $priv-&gt;decrypt($ct);

 #Signature: Alice
 my $priv = Crypt::PK::DSA-&gt;new(&#39;Alice_priv_dsa1.der&#39;);
 my $sig = $priv-&gt;sign_message($message);
 #
 #Signature: Bob (received $message + $sig)
 my $pub = Crypt::PK::DSA-&gt;new(&#39;Alice_pub_dsa1.der&#39;);
 $pub-&gt;verify_message($sig, $message) or die &quot;ERROR&quot;;

 #Key generation
 my $pk = Crypt::PK::DSA-&gt;new();
 $pk-&gt;generate_key(30, 256);
 my $private_der = $pk-&gt;export_key_der(&#39;private&#39;);
 my $public_der = $pk-&gt;export_key_der(&#39;public&#39;);
 my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;);
 my $public_pem = $pk-&gt;export_key_pem(&#39;public&#39;);

 ### Functional interface

 #Encryption: Alice
 my $ct = dsa_encrypt(&#39;Bob_pub_dsa1.der&#39;, &quot;secret message&quot;);
 #Encryption: Bob (received ciphertext $ct)
 my $pt = dsa_decrypt(&#39;Bob_priv_dsa1.der&#39;, $ct);

 #Signature: Alice
 my $sig = dsa_sign_message(&#39;Alice_priv_dsa1.der&#39;, $message);
 #Signature: Bob (received $message + $sig)
 dsa_verify_message(&#39;Alice_pub_dsa1.der&#39;, $sig, $message) or die &quot;ERROR&quot;;</code></pre>

<h1 id="METHODS">METHODS</h1>

<h2 id="new">new</h2>

<pre><code>  my $pk = Crypt::PK::DSA-&gt;new();
  #or
  my $pk = Crypt::PK::DSA-&gt;new($priv_or_pub_key_filename);
  #or
  my $pk = Crypt::PK::DSA-&gt;new(\$buffer_containing_priv_or_pub_key);</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code>  my $pk = Crypt::PK::DSA-&gt;new($priv_pem_key_filename, $password);
  #or
  my $pk = Crypt::PK::DSA-&gt;new(\$buffer_containing_priv_pem_key, $password);</code></pre>

<h2 id="generate_key">generate_key</h2>

<p>Uses Yarrow-based cryptographically strong random number generator seeded with random data taken from <code>/dev/random</code> (UNIX) or <code>CryptGenRandom</code> (Win32).</p>

<pre><code> $pk-&gt;generate_key($group_size, $modulus_size);
 # $group_size  ... in bytes .. 15 &lt; $group_size &lt; 1024
 # $modulus_size .. in bytes .. ($modulus_size - $group_size) &lt; 512

 ### Bits of Security according to libtomcrypt documentation
 # 80 bits   =&gt; generate_key(20, 128)
 # 120 bits  =&gt; generate_key(30, 256)
 # 140 bits  =&gt; generate_key(35, 384)
 # 160 bits  =&gt; generate_key(40, 512)

 ### Sizes according section 4.2 of FIPS 186-4
 # (L and N are the bit lengths of p and q respectively)
 # L = 1024, N = 160 =&gt; generate_key(20, 128)
 # L = 2048, N = 224 =&gt; generate_key(28, 256)
 # L = 2048, N = 256 =&gt; generate_key(32, 256)
 # L = 3072, N = 256 =&gt; generate_key(32, 384)

 $pk-&gt;generate_key($param_hash)
 # $param_hash is { d =&gt; $d, p =&gt; $p, q =&gt; $q }
 # where $d, $p, $q are hex strings

 $pk-&gt;generate_key(\$dsa_param)
 # $dsa_param is the content of DER or PEM file with DSA params
 # e.g. openssl dsaparam 2048</code></pre>

<h2 id="import_key">import_key</h2>

<p>Loads private or public key in DER or PEM format.</p>

<pre><code>  $pk-&gt;import_key($filename);
  #or
  $pk-&gt;import_key(\$buffer_containing_key);</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code>  $pk-&gt;import_key($pem_filename, $password);
  #or
  $pk-&gt;import_key(\$buffer_containing_pem_key, $password);</code></pre>

<p>Loading private or public keys form perl hash:</p>

<pre><code> $pk-&gt;import_key($hashref);

 # where $hashref is a key exported via key2hash
 $pk-&gt;import_key({
   p =&gt; &quot;AAF839A764E04D80824B79FA1F0496C093...&quot;, #prime modulus
   q =&gt; &quot;D05C4CB45F29D353442F1FEC43A6BE2BE8...&quot;, #prime divisor
   g =&gt; &quot;847E8896D12C9BF18FE283AE7AD58ED7F3...&quot;, #generator of a subgroup of order q in GF(p)
   x =&gt; &quot;6C801901AC74E2DC714D75A9F6969483CF...&quot;, #private key, random  0 &lt; x &lt; q
   y =&gt; &quot;8F7604D77FA62C7539562458A63C7611B7...&quot;, #public key, where y = g^x mod p
 });</code></pre>

<p>Supported key formats:</p>

<ul>

<li><p>DSA public keys</p>

<pre><code> -----BEGIN PUBLIC KEY-----
 MIIBtjCCASsGByqGSM44BAEwggEeAoGBAJKyu+puNMGLpGIhbD1IatnwlI79ePr4
 YHe2KBhRkheKxWUZRpN1Vd/+usS2IHSJ9op5cSWETiP05d7PMtJaitklw7jhudq3
 GxNvV/GRdCQm3H6d76FHP88dms4vcDYc6ry6wKERGfNEtZ+4BAKrMZK+gDYsF4Aw
 U6WVR969kYZhAhUA6w25FgSRmJ8W4XkvC60n8Wv3DpMCgYA4ZFE+3tLOM24PZj9Z
 rxuqUzZZdR+kIzrsIYpWN9ustbmdKLKwsqIaUIxc5zxHEhbAjAIf8toPD+VEQIpY
 7vgJgDhXuPq45BgN19iLTzOJwIhAFXPZvnAdIo9D/AnMw688gT6g6U8QCZwX2XYg
 ICiVcriYVNcjVKHSFY/X0Oi7CgOBhAACgYB4ZTn4OYT/pjUd6tNhGPtOS3CE1oaj
 5ScbetXg4ZDpceEyQi8VG+/ZTbs8var8X77JdEdeQA686cAxpOaVgW8V4odvcmfA
 BfueiGnPXjqGfppiHAyL1Ngyd+EsXKmKVXZYAVFVI0WuJKiZBSVURU7+ByxOfpGa
 fZhibr0SggWixQ==
 -----END PUBLIC KEY-----</code></pre>

</li>
<li><p>DSA private keys</p>

<pre><code> -----BEGIN DSA PRIVATE KEY-----
 MIIBuwIBAAKBgQCSsrvqbjTBi6RiIWw9SGrZ8JSO/Xj6+GB3tigYUZIXisVlGUaT
 dVXf/rrEtiB0ifaKeXElhE4j9OXezzLSWorZJcO44bnatxsTb1fxkXQkJtx+ne+h
 Rz/PHZrOL3A2HOq8usChERnzRLWfuAQCqzGSvoA2LBeAMFOllUfevZGGYQIVAOsN
 uRYEkZifFuF5LwutJ/Fr9w6TAoGAOGRRPt7SzjNuD2Y/Wa8bqlM2WXUfpCM67CGK
 VjfbrLW5nSiysLKiGlCMXOc8RxIWwIwCH/LaDw/lRECKWO74CYA4V7j6uOQYDdfY
 i08zicCIQBVz2b5wHSKPQ/wJzMOvPIE+oOlPEAmcF9l2ICAolXK4mFTXI1Sh0hWP
 19DouwoCgYB4ZTn4OYT/pjUd6tNhGPtOS3CE1oaj5ScbetXg4ZDpceEyQi8VG+/Z
 Tbs8var8X77JdEdeQA686cAxpOaVgW8V4odvcmfABfueiGnPXjqGfppiHAyL1Ngy
 d+EsXKmKVXZYAVFVI0WuJKiZBSVURU7+ByxOfpGafZhibr0SggWixQIVAL7Sia03
 8bvANjjL9Sitk8slrM6P
 -----END DSA PRIVATE KEY-----</code></pre>

</li>
<li><p>DSA private keys in password protected PEM format:</p>

<pre><code> -----BEGIN DSA PRIVATE KEY-----
 Proc-Type: 4,ENCRYPTED
 DEK-Info: DES-CBC,227ADC3AA0299491

 UISxBYAxPQMl2eK9LMAeHsssF6IxO+4G2ta2Jn8VE+boJrrH3iSTKeMXGjGaXl0z
 DwcLGV+KMR70y+cxtTb34rFy+uSpBy10dOQJhxALDbe1XfCDQIUfaXRfMNA3um2I
 JdZixUD/zcxBOUzao+MCr0V9XlJDgqBhJ5EEr53XHH07Eo5fhiBfbbR9NzdUPFrQ
 p2ASyZtFh7RXoIBUCQgg21oeLddcNWV7gd/Y46kghO9s0JbJ8C+IsuWEPRSq502h
 tSoDN6B0sxbVvOUICLLbQaxt7yduTAhRxVIJZ1PWATTVD7CZBVz9uIDZ7LOv+er2
 1q3vkwb8E9spPsA240+BnfD571XEop4jrawxC0VKQZ+3cPVLc6jhIsxvzzFQUt67
 g66v8GUgt7KF3KhVV7qEtntybQWDWb+K/uTIH9Ra8nP820d3Rnl61pPXDPlluteT
 WSLOvEMN2zRmkaxQNv/tLdT0SYpQtdjw74G3A6T7+KnvinKrjtp1a/AXkCF9hNEx
 DGbxOYo1UOmk8qdxWCrab34nO+Q8oQc9wjXHG+ZtRYIMoGMKREK8DeL4H1RPNkMf
 rwXWk8scd8QFmJAb8De1VQ==
 -----END DSA PRIVATE KEY-----</code></pre>

</li>
<li><p>SSH public DSA keys</p>

<pre><code> ssh-dss AAAAB3NzaC1kc3MAAACBAKU8/avmk...4XOwuEssAVhmwA==</code></pre>

</li>
<li><p>SSH public DSA keys (RFC-4716 format)</p>

<pre><code> ---- BEGIN SSH2 PUBLIC KEY ----
 Comment: &quot;1024-bit DSA, converted from OpenSSH&quot;
 AAAAB3NzaC1kc3MAAACBAKU8/avmkFeGnSqwYG7dZnQlG+01QNaxu3F5v0NcL/SRUW7Idp
 Uq8t14siK0mA6yjphLhOf5t8gugTEVBllP86ANSbFigH7WN3v6ydJWqm60pNhNHN//50cn
 NtIsXbxeq3VtsI64pkH1OJqeZDHLmu73k4T0EKOzsylSfF/wtVBJAAAAFQChpubLHViwPB
 +jSvUb8e4THS7PBQAAAIAJD1PMCiTCQa1xyD/NCWOajCufTOIzKAhm6l+nlBVPiKI+262X
 pYt127Ke4mPL8XJBizoTjSQN08uHMg/8L6W/cdO2aZ+mhkBnS1xAm83DAwqLrDraR1w/4Q
 RFxr5Vbyy8qnejrPjTJobBN1BGsv84wHkjmoCn6pFIfkGYeATlJgAAAIAHYPU1zMVBTDWr
 u7SNC4G2UyWGWYYLjLytBVHfQmBa51CmqrSs2kCfGLGA1ynfYENsxcJq9nsXrb4i17H5BH
 JFkH0g7BUDpeBeLr8gsK3WgfqWwtZsDkltObw9chUD/siK6q/dk/fSIB2Ho0inev7k68Z5
 ZkNI4XOwuEssAVhmwA==
 ---- END SSH2 PUBLIC KEY ----</code></pre>

</li>
</ul>

<h2 id="export_key_der">export_key_der</h2>

<pre><code> my $private_der = $pk-&gt;export_key_der(&#39;private&#39;);
 #or
 my $public_der = $pk-&gt;export_key_der(&#39;public&#39;);</code></pre>

<h2 id="export_key_pem">export_key_pem</h2>

<pre><code> my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;);
 #or
 my $public_pem = $pk-&gt;export_key_pem(&#39;public&#39;);
 #or
 my $public_pem = $pk-&gt;export_key_pem(&#39;public_x509&#39;);</code></pre>

<p>With parameter <code>&#39;public&#39;</code> uses header and footer lines:</p>

<pre><code>  -----BEGIN DSA PUBLIC KEY------
  -----END DSA PUBLIC KEY------</code></pre>

<p>With parameter <code>&#39;public_x509&#39;</code> uses header and footer lines:</p>

<pre><code>  -----BEGIN PUBLIC KEY------
  -----END PUBLIC KEY------</code></pre>

<p>Support for password protected PEM keys</p>

<pre><code> my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;, $password);
 #or
 my $private_pem = $pk-&gt;export_key_pem(&#39;private&#39;, $password, $cipher);

 # supported ciphers: &#39;DES-CBC&#39;
 #                    &#39;DES-EDE3-CBC&#39;
 #                    &#39;SEED-CBC&#39;
 #                    &#39;CAMELLIA-128-CBC&#39;
 #                    &#39;CAMELLIA-192-CBC&#39;
 #                    &#39;CAMELLIA-256-CBC&#39;
 #                    &#39;AES-128-CBC&#39;
 #                    &#39;AES-192-CBC&#39;
 #                    &#39;AES-256-CBC&#39; (DEFAULT)</code></pre>

<h2 id="encrypt">encrypt</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($pub_key_filename);
 my $ct = $pk-&gt;encrypt($message);
 #or
 my $ct = $pk-&gt;encrypt($message, $hash_name);

 #NOTE: $hash_name can be &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest</code></pre>

<h2 id="decrypt">decrypt</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($priv_key_filename);
 my $pt = $pk-&gt;decrypt($ciphertext);</code></pre>

<h2 id="sign_message">sign_message</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($priv_key_filename);
 my $signature = $priv-&gt;sign_message($message);
 #or
 my $signature = $priv-&gt;sign_message($message, $hash_name);

 #NOTE: $hash_name can be &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest</code></pre>

<h2 id="verify_message">verify_message</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($pub_key_filename);
 my $valid = $pub-&gt;verify_message($signature, $message)
 #or
 my $valid = $pub-&gt;verify_message($signature, $message, $hash_name);

 #NOTE: $hash_name can be &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest</code></pre>

<h2 id="sign_hash">sign_hash</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($priv_key_filename);
 my $signature = $priv-&gt;sign_hash($message_hash);</code></pre>

<h2 id="verify_hash">verify_hash</h2>

<pre><code> my $pk = Crypt::PK::DSA-&gt;new($pub_key_filename);
 my $valid = $pub-&gt;verify_hash($signature, $message_hash);</code></pre>

<h2 id="is_private">is_private</h2>

<pre><code> my $rv = $pk-&gt;is_private;
 # 1 .. private key loaded
 # 0 .. public key loaded
 # undef .. no key loaded</code></pre>

<h2 id="size">size</h2>

<pre><code> my $size = $pk-&gt;size;
 # returns key size (length of the prime p) in bytes or undef if key not loaded</code></pre>

<h2 id="size_q">size_q</h2>

<pre><code> my $size = $pk-&gt;size_q;
 # returns length of the prime q in bytes or undef if key not loaded</code></pre>

<h2 id="key2hash">key2hash</h2>

<pre><code> my $hash = $pk-&gt;key2hash;

 # returns hash like this (or undef if no key loaded):
 {
   type =&gt; 1,   # integer: 1 .. private, 0 .. public
   size =&gt; 256, # integer: key size in bytes
   # all the rest are hex strings
   p =&gt; &quot;AAF839A764E04D80824B79FA1F0496C093...&quot;, #prime modulus
   q =&gt; &quot;D05C4CB45F29D353442F1FEC43A6BE2BE8...&quot;, #prime divisor
   g =&gt; &quot;847E8896D12C9BF18FE283AE7AD58ED7F3...&quot;, #generator of a subgroup of order q in GF(p)
   x =&gt; &quot;6C801901AC74E2DC714D75A9F6969483CF...&quot;, #private key, random  0 &lt; x &lt; q
   y =&gt; &quot;8F7604D77FA62C7539562458A63C7611B7...&quot;, #public key, where y = g^x mod p
 }</code></pre>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<h2 id="dsa_encrypt">dsa_encrypt</h2>

<p>DSA based encryption as implemented by libtomcrypt. See method <a href="#encrypt">&quot;encrypt&quot;</a> below.</p>

<pre><code> my $ct = dsa_encrypt($pub_key_filename, $message);
 #or
 my $ct = dsa_encrypt(\$buffer_containing_pub_key, $message);
 #or
 my $ct = dsa_encrypt($pub_key_filename, $message, $hash_name);

 #NOTE: $hash_name can be &#39;SHA1&#39; (DEFAULT), &#39;SHA256&#39; or any other hash supported by Crypt::Digest</code></pre>

<p>Encryption works similar to the <a href="../../../../../../root/.cpanm/work/1586740115.5251/CryptX-0.068/blib/lib/Crypt/PK/ECC.html">Crypt::PK::ECC</a> encryption whereas shared DSA key is computed, and the hash of the shared key XOR&#39;ed against the plaintext forms the ciphertext.</p>

<h2 id="dsa_decrypt">dsa_decrypt</h2>

<p>DSA based decryption as implemented by libtomcrypt. See method <a href="#decrypt">&quot;decrypt&quot;</a> below.</p>

<pre><code> my $pt = dsa_decrypt($priv_key_filename, $ciphertext);
 #or
 my $pt = dsa_decrypt(\$buffer_containing_priv_key, $ciphertext);</code></pre>

<h2 id="dsa_sign_message">dsa_sign_message</h2>

<p>Generate DSA signature. See method <a href="#sign_message">&quot;sign_message&quot;</a> below.</p>

<pre><code> my $sig = dsa_sign_message($priv_key_filename, $message);
 #or
 my $sig = dsa_sign_message(\$buffer_containing_priv_key, $message);
 #or
 my $sig = dsa_sign_message($priv_key, $message, $hash_name);</code></pre>

<h2 id="dsa_verify_message">dsa_verify_message</h2>

<p>Verify DSA signature. See method <a href="#verify_message">&quot;verify_message&quot;</a> below.</p>

<pre><code> dsa_verify_message($pub_key_filename, $signature, $message) or die &quot;ERROR&quot;;
 #or
 dsa_verify_message(\$buffer_containing_pub_key, $signature, $message) or die &quot;ERROR&quot;;
 #or
 dsa_verify_message($pub_key, $signature, $message, $hash_name) or die &quot;ERROR&quot;;</code></pre>

<h2 id="dsa_sign_hash">dsa_sign_hash</h2>

<p>Generate DSA signature. See method <a href="#sign_hash">&quot;sign_hash&quot;</a> below.</p>

<pre><code> my $sig = dsa_sign_hash($priv_key_filename, $message_hash);
 #or
 my $sig = dsa_sign_hash(\$buffer_containing_priv_key, $message_hash);</code></pre>

<h2 id="dsa_verify_hash">dsa_verify_hash</h2>

<p>Verify DSA signature. See method <a href="#verify_hash">&quot;verify_hash&quot;</a> below.</p>

<pre><code> dsa_verify_hash($pub_key_filename, $signature, $message_hash) or die &quot;ERROR&quot;;
 #or
 dsa_verify_hash(\$buffer_containing_pub_key, $signature, $message_hash) or die &quot;ERROR&quot;;</code></pre>

<h1 id="OpenSSL-interoperability">OpenSSL interoperability</h1>

<pre><code> ### let&#39;s have:
 # DSA private key in PEM format - dsakey.priv.pem
 # DSA public key in PEM format  - dsakey.pub.pem
 # data file to be signed - input.data</code></pre>

<h2 id="Sign-by-OpenSSL-verify-by-Crypt::PK::DSA">Sign by OpenSSL, verify by Crypt::PK::DSA</h2>

<p>Create signature (from commandline):</p>

<pre><code> openssl dgst -sha1 -sign dsakey.priv.pem -out input.sha1-dsa.sig input.data</code></pre>

<p>Verify signature (Perl code):</p>

<pre><code> use Crypt::PK::DSA;
 use Crypt::Digest &#39;digest_file&#39;;
 use Crypt::Misc &#39;read_rawfile&#39;;

 my $pkdsa = Crypt::PK::DSA-&gt;new(&quot;dsakey.pub.pem&quot;);
 my $signature = read_rawfile(&quot;input.sha1-dsa.sig&quot;);
 my $valid = $pkdsa-&gt;verify_hash($signature, digest_file(&quot;SHA1&quot;, &quot;input.data&quot;), &quot;SHA1&quot;, &quot;v1.5&quot;);
 print $valid ? &quot;SUCCESS&quot; : &quot;FAILURE&quot;;</code></pre>

<h2 id="Sign-by-Crypt::PK::DSA-verify-by-OpenSSL">Sign by Crypt::PK::DSA, verify by OpenSSL</h2>

<p>Create signature (Perl code):</p>

<pre><code> use Crypt::PK::DSA;
 use Crypt::Digest &#39;digest_file&#39;;
 use Crypt::Misc &#39;write_rawfile&#39;;

 my $pkdsa = Crypt::PK::DSA-&gt;new(&quot;dsakey.priv.pem&quot;);
 my $signature = $pkdsa-&gt;sign_hash(digest_file(&quot;SHA1&quot;, &quot;input.data&quot;), &quot;SHA1&quot;, &quot;v1.5&quot;);
 write_rawfile(&quot;input.sha1-dsa.sig&quot;, $signature);</code></pre>

<p>Verify signature (from commandline):</p>

<pre><code> openssl dgst -sha1 -verify dsakey.pub.pem -signature input.sha1-dsa.sig input.data</code></pre>

<h2 id="Keys-generated-by-Crypt::PK::DSA">Keys generated by Crypt::PK::DSA</h2>

<p>Generate keys (Perl code):</p>

<pre><code> use Crypt::PK::DSA;
 use Crypt::Misc &#39;write_rawfile&#39;;

 my $pkdsa = Crypt::PK::DSA-&gt;new;
 $pkdsa-&gt;generate_key(20, 128);
 write_rawfile(&quot;dsakey.pub.der&quot;,  $pkdsa-&gt;export_key_der(&#39;public&#39;));
 write_rawfile(&quot;dsakey.priv.der&quot;, $pkdsa-&gt;export_key_der(&#39;private&#39;));
 write_rawfile(&quot;dsakey.pub.pem&quot;,  $pkdsa-&gt;export_key_pem(&#39;public_x509&#39;));
 write_rawfile(&quot;dsakey.priv.pem&quot;, $pkdsa-&gt;export_key_pem(&#39;private&#39;));
 write_rawfile(&quot;dsakey-passwd.priv.pem&quot;, $pkdsa-&gt;export_key_pem(&#39;private&#39;, &#39;secret&#39;));</code></pre>

<p>Use keys by OpenSSL:</p>

<pre><code> openssl dsa -in dsakey.priv.der -text -inform der
 openssl dsa -in dsakey.priv.pem -text
 openssl dsa -in dsakey-passwd.priv.pem -text -inform pem -passin pass:secret
 openssl dsa -in dsakey.pub.der -pubin -text -inform der
 openssl dsa -in dsakey.pub.pem -pubin -text</code></pre>

<h2 id="Keys-generated-by-OpenSSL">Keys generated by OpenSSL</h2>

<p>Generate keys:</p>

<pre><code> openssl dsaparam -genkey -out dsakey.priv.pem 1024
 openssl dsa -in dsakey.priv.pem -out dsakey.priv.der -outform der
 openssl dsa -in dsakey.priv.pem -out dsakey.pub.pem -pubout
 openssl dsa -in dsakey.priv.pem -out dsakey.pub.der -outform der -pubout
 openssl dsa -in dsakey.priv.pem -passout pass:secret -des3 -out dsakey-passwd.priv.pem</code></pre>

<p>Load keys (Perl code):</p>

<pre><code> use Crypt::PK::DSA;

 my $pkdsa = Crypt::PK::DSA-&gt;new;
 $pkdsa-&gt;import_key(&quot;dsakey.pub.der&quot;);
 $pkdsa-&gt;import_key(&quot;dsakey.priv.der&quot;);
 $pkdsa-&gt;import_key(&quot;dsakey.pub.pem&quot;);
 $pkdsa-&gt;import_key(&quot;dsakey.priv.pem&quot;);
 $pkdsa-&gt;import_key(&quot;dsakey-passwd.priv.pem&quot;, &quot;secret&quot;);</code></pre>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<ul>

<li><p><a href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm">https://en.wikipedia.org/wiki/Digital_Signature_Algorithm</a></p>

</li>
</ul>


</body>

</html>


